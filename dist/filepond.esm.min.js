/*
 * FilePond 4.0.2
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */

/* eslint-disable */
const isNode=e=>e instanceof HTMLElement,createStore=(e,t=[],r=[])=>{const o=Object.assign({},e),i=[],n=[],a=(e,t,r)=>{r?n.push({type:e,data:t}):(p[e]&&p[e](t),i.push({type:e,data:t}))},s=(e,...t)=>c[e]?c[e](...t):null,l={getState:()=>Object.assign({},o),processActionQueue:()=>{const e=[...i];return i.length=0,e},processDispatchQueue:()=>{const e=[...n];n.length=0,e.forEach(({type:e,data:t})=>{a(e,t)})},dispatch:a,query:s};let c={};t.forEach(e=>{c=Object.assign({},e(o),c)});let p={};return r.forEach(e=>{p=Object.assign({},e(a,s,o),p)}),l},defineProperty=(e,t,r)=>{"function"!=typeof r?Object.defineProperty(e,t,Object.assign({},r)):e[t]=r},forin=(e,t)=>{for(const r in e)e.hasOwnProperty(r)&&t(r,e[r])},createObject=e=>{const t={};return forin(e,r=>{defineProperty(t,r,e[r])}),t},attr=(e,t,r=null)=>{if(null===r)return e.getAttribute(t)||e.hasAttribute(t);e.setAttribute(t,r)},ns="http://www.w3.org/2000/svg",svgElements=["svg","path"],isSVGElement=e=>svgElements.includes(e),createElement=(e,t,r={})=>{"object"==typeof t&&(r=t,t=null);const o=isSVGElement(e)?document.createElementNS(ns,e):document.createElement(e);return t&&(isSVGElement(e)?attr(o,"class",t):o.className=t),forin(r,(e,t)=>{attr(o,e,t)}),o},appendChild=e=>(t,r)=>{void 0!==r&&e.children[r]?e.insertBefore(t,e.children[r]):e.appendChild(t)},appendChildView=(e,t)=>(e,r)=>(void 0!==r?t.splice(r,0,e):t.push(e),e),removeChildView=(e,t)=>r=>(t.splice(t.indexOf(r),1),r.element.parentNode&&e.removeChild(r.element),r),getViewRect=(e,t,r,o)=>{const i=r[0]||e.left,n=r[1]||e.top,a=i+e.width,s=n+e.height*(o[1]||1),l={element:Object.assign({},e),inner:{left:e.left,top:e.top,right:e.right,bottom:e.bottom},outer:{left:i,top:n,right:a,bottom:s}};return t.filter(e=>!e.isRectIgnored()).map(e=>e.rect).forEach(e=>{expandRect(l.inner,Object.assign({},e.inner)),expandRect(l.outer,Object.assign({},e.outer))}),calculateRectSize(l.inner),l.outer.bottom+=l.element.marginBottom,l.outer.right+=l.element.marginRight,calculateRectSize(l.outer),l},expandRect=(e,t)=>{t.top+=e.top,t.right+=e.left,t.bottom+=e.top,t.left+=e.left,t.bottom>e.bottom&&(e.bottom=t.bottom),t.right>e.right&&(e.right=t.right)},calculateRectSize=e=>{e.width=e.right-e.left,e.height=e.bottom-e.top},isNumber=e=>"number"==typeof e,thereYet=(e,t,r,o=.001)=>Math.abs(e-t)<o&&Math.abs(r)<o,spring=({stiffness:e=.5,damping:t=.75,mass:r=10}={})=>{let o=null,i=null,n=0,a=!1;const s=createObject({interpolate:()=>{if(a)return;if(!isNumber(o)||!isNumber(i))return a=!0,void(n=0);thereYet(i+=n+=-(i-o)*e/r,o,n*=t)?(i=o,n=0,a=!0,s.onupdate(i),s.oncomplete(i)):s.onupdate(i)},target:{set:e=>{if(isNumber(e)&&!isNumber(i)&&(i=e),null===o&&(o=e,i=e),o=e,i===o||void 0===o)return a=!0,n=0,s.onupdate(i),void s.oncomplete(i);a=!1},get:()=>o},resting:{get:()=>a},onupdate:e=>{},oncomplete:e=>{}});return s},easeInOutQuad=e=>e<.5?2*e*e:(4-2*e)*e-1,tween=({duration:e=500,easing:t=easeInOutQuad,delay:r=0}={})=>{let o,i,n=null,a=!0,s=!1,l=null;const c=createObject({interpolate:p=>{a||null===l||(null===n&&(n=p),p-n<r||((o=p-n-r)<e?(i=o/e,c.onupdate((o>=0?t(s?1-i:i):0)*l)):(o=1,i=s?0:1,c.onupdate(i*l),c.oncomplete(i*l),a=!0)))},target:{get:()=>s?0:l,set:e=>{if(null===l)return l=e,c.onupdate(e),void c.oncomplete(e);e<l?(l=1,s=!0):(s=!1,l=e),a=!1,n=null}},resting:{get:()=>a},onupdate:e=>{},oncomplete:e=>{}});return c},animator={spring:spring,tween:tween},createAnimator=(e,t,r)=>{const o=e[t]&&"object"==typeof e[t][r]?e[t][r]:e[t]||e,i="string"==typeof o?o:o.type,n="object"==typeof o?Object.assign({},o):{};return animator[i]?animator[i](n):null},addGetSet=(e,t,r,o=!1)=>{(t=Array.isArray(t)?t:[t]).forEach(t=>{e.forEach(e=>{let i=e,n=()=>r[e],a=t=>r[e]=t;"object"==typeof e&&(i=e.key,n=e.getter||n,a=e.setter||a),t[i]&&!o||(t[i]={get:n,set:a})})})},isDefined=e=>null!=e,animations=({mixinConfig:e,viewProps:t,viewInternalAPI:r,viewExternalAPI:o,viewState:i})=>{const n=Object.assign({},t),a=[];return forin(e,(e,i)=>{const s=createAnimator(i);if(!s)return;s.onupdate=(r=>{t[e]=r}),s.target=n[e];addGetSet([{key:e,setter:e=>{s.target!==e&&(s.target=e)},getter:()=>t[e]}],[r,o],t,!0),a.push(s)}),{write:e=>{let t=!0;return a.forEach(r=>{r.resting||(t=!1),r.interpolate(e)}),t},destroy:()=>{}}},addEvent=e=>(t,r)=>{e.addEventListener(t,r)},removeEvent=e=>(t,r)=>{e.removeEventListener(t,r)},listeners=({mixinConfig:e,viewProps:t,viewInternalAPI:r,viewExternalAPI:o,viewState:i,view:n})=>{const a=[],s=addEvent(n.element),l=removeEvent(n.element);return o.on=((e,t)=>{a.push({type:e,fn:t}),s(e,t)}),o.off=((e,t)=>{a.splice(a.findIndex(r=>r.type===e&&r.fn===t),1),l(e,t)}),{write:()=>!0,destroy:()=>{a.forEach(e=>{l(e.type,e.fn)})}}},apis=({mixinConfig:e,viewProps:t,viewExternalAPI:r})=>{addGetSet(e,r,t)},defaults={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},styles=({mixinConfig:e,viewProps:t,viewInternalAPI:r,viewExternalAPI:o,view:i})=>{const n=Object.assign({},t),a={};addGetSet(e,[r,o],t);const s=()=>i.rect?getViewRect(i.rect,i.childViews,[t.translateX||0,t.translateY||0],[t.scaleX||0,t.scaleY||0]):null;return r.rect={get:s},o.rect={get:s},e.forEach(e=>{t[e]=void 0===n[e]?defaults[e]:n[e]}),{write:()=>{if(propsHaveChanged(a,t))return applyStyles(i.element,t),Object.assign(a,Object.assign({},t)),!0},destroy:()=>{}}},propsHaveChanged=(e,t)=>{if(Object.keys(e).length!==Object.keys(t).length)return!0;for(const r in t)if(t[r]!==e[r])return!0;return!1},applyStyles=(e,{opacity:t,perspective:r,translateX:o,translateY:i,scaleX:n,scaleY:a,rotateX:s,rotateY:l,rotateZ:c,originX:p,originY:d,width:u,height:m})=>{let E="",I="";(isDefined(p)||isDefined(d))&&(I+=`transform-origin: ${p||0}px ${d||0}px;`),isDefined(r)&&(E+=`perspective(${r}px) `),(isDefined(o)||isDefined(i))&&(E+=`translate3d(${o||0}px, ${i||0}px, 0) `),(isDefined(n)||isDefined(a))&&(E+=`scale3d(${isDefined(n)?n:1}, ${isDefined(a)?a:1}, 1) `),isDefined(c)&&(E+=`rotateZ(${c}rad) `),isDefined(s)&&(E+=`rotateX(${s}rad) `),isDefined(l)&&(E+=`rotateY(${l}rad) `),E.length&&(I+=`transform:${E};`),isDefined(t)&&(I+=`opacity:${t};`,0===t&&(I+="visibility:hidden;"),t<1&&(I+="pointer-events:none;")),isDefined(m)&&(I+=`height:${m}px;`),isDefined(u)&&(I+=`width:${u}px;`);const T=e.elementCurrentStyle||"";I.length===T.length&&I===T||(e.setAttribute("style",I),e.elementCurrentStyle=I)},Mixins={styles:styles,listeners:listeners,animations:animations,apis:apis},updateRect=(e={},t={},r={})=>(t.layoutCalculated||(e.paddingTop=parseInt(r.paddingTop,10)||0,e.marginTop=parseInt(r.marginTop,10)||0,e.marginRight=parseInt(r.marginRight,10)||0,e.marginBottom=parseInt(r.marginBottom,10)||0,e.marginLeft=parseInt(r.marginLeft,10)||0,t.layoutCalculated=!0),e.left=t.offsetLeft||0,e.top=t.offsetTop||0,e.width=t.offsetWidth||0,e.height=t.offsetHeight||0,e.right=e.left+e.width,e.bottom=e.top+e.height,e.scrollTop=t.scrollTop,e.hidden=null===t.offsetParent,e),createView=({tag:e="div",name:t=null,attributes:r={},read:o=(()=>{}),write:i=(()=>{}),create:n=(()=>{}),destroy:a=(()=>{}),filterFrameActionsForChild:s=((e,t)=>t),didCreateView:l=(()=>{}),didWriteView:c=(()=>{}),ignoreRect:p=!1,ignoreRectUpdate:d=!1,mixins:u=[]}={})=>(m,E={})=>{const I=createElement(e,`filepond--${t}`,r),T=window.getComputedStyle(I,null),g=updateRect();let f=null,_=!1;const R=[],O=[],y={},h={},S=[i],D=[o],P=[a],b=()=>I,A=()=>[...R],v=()=>f||(f=getViewRect(g,R,[0,0],[1,1])),M={element:{get:b},style:{get:()=>T},childViews:{get:A}},L=Object.assign({},M,{rect:{get:v},ref:{get:()=>y},is:e=>t===e,appendChild:appendChild(I),createChildView:(e=>(t,r)=>t(e,r))(m),linkView:e=>(R.push(e),e),unlinkView:e=>{R.splice(R.indexOf(e),1)},appendChildView:appendChildView(0,R),removeChildView:removeChildView(I,R),registerWriter:e=>S.push(e),registerReader:e=>D.push(e),registerDestroyer:e=>P.push(e),invalidateLayout:()=>I.layoutCalculated=!1,dispatch:m.dispatch,query:m.query}),w={element:{get:b},childViews:{get:A},rect:{get:v},resting:{get:()=>_},isRectIgnored:()=>p,_read:()=>{f=null,R.forEach(e=>e._read());!(d&&g.width&&g.height)&&updateRect(g,I,T);const e={root:C,props:E,rect:g};D.forEach(t=>t(e))},_write:(e,t,r)=>{let o=0===t.length;return S.forEach(i=>{!1===i({props:E,root:C,actions:t,timestamp:e,shouldOptimize:r})&&(o=!1)}),O.forEach(t=>{!1===t.write(e)&&(o=!1)}),R.filter(e=>!!e.element.parentNode).forEach(i=>{i._write(e,s(i,t),r)||(o=!1)}),R.forEach((i,n)=>{i.element.parentNode||(C.appendChild(i.element,n),i._read(),i._write(e,s(i,t),r),o=!1)}),_=o,c({props:E,root:C,actions:t,timestamp:e}),o},_destroy:()=>{O.forEach(e=>e.destroy()),P.forEach(e=>{e({root:C,props:E})}),R.forEach(e=>e._destroy())}},N=Object.assign({},M,{rect:{get:()=>g}});Object.keys(u).sort((e,t)=>"styles"===e?1:"styles"===t?-1:0).forEach(e=>{const t=Mixins[e]({mixinConfig:u[e],viewProps:E,viewState:h,viewInternalAPI:L,viewExternalAPI:w,view:createObject(N)});t&&O.push(t)});const C=createObject(L);n({root:C,props:E});const F=I.children.length;return R.forEach((e,t)=>{C.appendChild(e.element,F+t)}),l(C),createObject(w)},createPainter=(e,t,r=60)=>{const o="__framePainter";if(window[o])return window[o].readers.push(e),void window[o].writers.push(t);window[o]={readers:[e],writers:[t]};const i=window[o],n=1e3/r;let a=null,s=null;const l=e=>{s=window.requestAnimationFrame(l),a||(a=e);const t=e-a;t<=n||(a=e-t%n,i.readers.forEach(e=>e()),i.writers.forEach(t=>t(e)))};return l(performance.now()),{pause:()=>{window.cancelAnimationFrame(s)}}},createRoute=(e,t)=>({root:r,props:o,actions:i=[],timestamp:n,shouldOptimize:a})=>{i.filter(t=>e[t.type]).forEach(t=>e[t.type]({root:r,props:o,action:t.data,timestamp:n,shouldOptimize:a})),t&&t({root:r,props:o,actions:i,timestamp:n,shouldOptimize:a})},insertBefore=(e,t)=>t.parentNode.insertBefore(e,t),insertAfter=(e,t)=>t.parentNode.insertBefore(e,t.nextSibling),isArray=e=>Array.isArray(e),isEmpty=e=>null==e,trim=e=>e.trim(),toString=e=>""+e,toArray=(e,t=",")=>isEmpty(e)?[]:isArray(e)?e:toString(e).split(t).map(trim).filter(e=>e.length),isBoolean=e=>"boolean"==typeof e,toBoolean=e=>isBoolean(e)?e:"true"===e,isString=e=>"string"==typeof e,toNumber=e=>isNumber(e)?e:isString(e)?toString(e).replace(/[a-z]+/gi,""):0,toInt=e=>parseInt(toNumber(e),10),toFloat=e=>parseFloat(toNumber(e)),isInt=e=>isNumber(e)&&isFinite(e)&&Math.floor(e)===e,toBytes=e=>{if(isInt(e))return e;let t=toString(e).trim();return/MB$/i.test(t)?(t=t.replace(/MB$i/,"").trim(),1e3*toInt(t)*1e3):/KB/i.test(t)?(t=t.replace(/KB$i/,"").trim(),1e3*toInt(t)):toInt(t)},isFunction=e=>"function"==typeof e,toFunctionReference=e=>{let t=self,r=e.split("."),o=null;for(;o=r.shift();)if(!(t=t[o]))return null;return t},methods={process:"POST",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},createServerAPI=e=>{const t={};return t.url=isString(e)?e:e.url||"",t.timeout=e.timeout?parseInt(e.timeout,10):0,forin(methods,r=>{t[r]=createAction(r,e[r],methods[r],t.timeout)}),t.remove=e.remove||null,t},createAction=(e,t,r,o)=>{if(null===t)return null;if("function"==typeof t)return t;const i={url:"GET"===r?`?${e}=`:"",method:r,headers:{},withCredentials:!1,timeout:o,onload:null,ondata:null,onerror:null};if(isString(t))return i.url=t,i;if(Object.assign(i,t),isString(i.headers)){const e=i.headers.split(/:(.+)/);i.headers={header:e[0],value:e[1]}}return i.withCredentials=toBoolean(i.withCredentials),i},toServerAPI=e=>createServerAPI(e),isNull=e=>null===e,isObject=e=>"object"==typeof e&&null!==e,isAPI=e=>isObject(e)&&isString(e.url)&&isObject(e.process)&&isObject(e.revert)&&isObject(e.restore)&&isObject(e.fetch),getType=e=>isArray(e)?"array":isNull(e)?"null":isInt(e)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(e)?"bytes":isAPI(e)?"api":typeof e,replaceSingleQuotes=e=>e.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",'),conversionTable={array:toArray,boolean:toBoolean,int:e=>"bytes"===getType(e)?toBytes(e):toInt(e),float:toFloat,bytes:toBytes,string:e=>isFunction(e)?e:toString(e),serverapi:toServerAPI,object:e=>{try{return JSON.parse(replaceSingleQuotes(e))}catch(e){return null}},function:e=>toFunctionReference(e)},convertTo=(e,t)=>conversionTable[t](e),getValueByType=(e,t,r)=>{if(e===t)return e;let o=getType(e);if(o!==r){const t=convertTo(e,r);if(o=getType(t),null===t)throw`Trying to assign value with incorrect type to "${option}", allowed type: "${r}"`;e=t}return e},createOption=(e,t)=>{let r=e;return{enumerable:!0,get:()=>r,set:o=>{r=getValueByType(o,e,t)}}},createOptions=e=>{const t={};return forin(e,r=>{const o=e[r];t[r]=createOption(o[0],o[1])}),createObject(t)},createInitialState=e=>({items:[],listUpdateTimeout:null,processingQueue:[],options:createOptions(e)}),fromCamels=(e,t="-")=>e.split(/(?=[A-Z])/).map(e=>e.toLowerCase()).join(t),createOptionAPI=(e,t)=>{const r={};return forin(t,t=>{r[t]={get:()=>e.getState().options[t],set:r=>{e.dispatch(`SET_${fromCamels(t,"_").toUpperCase()}`,{value:r})}}}),r},createOptionActions=e=>(t,r,o)=>{const i={};return forin(e,e=>{const r=fromCamels(e,"_").toUpperCase();i[`SET_${r}`]=(i=>{try{o.options[e]=i.value}catch(e){}t(`DID_SET_${r}`,{value:o.options[e]})})}),i},createOptionQueries=e=>t=>{const r={};return forin(e,e=>{r[`GET_${fromCamels(e,"_").toUpperCase()}`]=(r=>t.options[e])}),r},InteractionMethod={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5},getUniqueId=()=>Math.random().toString(36).substr(2,9),arrayRemove=(e,t)=>e.splice(t,1),on=()=>{const e=[],t=(t,r)=>{arrayRemove(e,e.findIndex(e=>e.event===t&&(e.cb===r||!r)))};return{fire:(t,...r)=>{e.filter(e=>e.event===t).map(e=>e.cb).forEach(e=>{setTimeout(()=>{e(...r)},0)})},on:(t,r)=>{e.push({event:t,cb:r})},onOnce:(r,o)=>{e.push({event:r,cb:(...e)=>{t(r,o),o(...e)}})},off:t}},copyObjectPropertiesToObject=(e,t,r)=>{Object.getOwnPropertyNames(e).filter(e=>!r.includes(e)).forEach(r=>Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r)))},PRIVATE=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing"],createItemAPI=e=>{const t={};return copyObjectPropertiesToObject(e,t,PRIVATE),t},removeReleasedItems=e=>{e.forEach((t,r)=>{t.released&&arrayRemove(e,r)})},getNonNumeric=e=>/[^0-9]+/.exec(e),getDecimalSeparator=()=>getNonNumeric(1.1.toLocaleString())[0],getThousandsSeparator=()=>{const e=getDecimalSeparator(),t=1e3.toLocaleString();return t!==1e3.toString()?getNonNumeric(t)[0]:"."===e?",":"."},Type={BOOLEAN:"boolean",INT:"int",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},filters=[],applyFilterChain=(e,t,r)=>new Promise((o,i)=>{const n=filters.filter(t=>t.key===e).map(e=>e.cb);if(0===n.length)return void o(t);const a=n.shift();n.reduce((e,t)=>e.then(e=>t(e,r)),a(t,r)).then(e=>o(e)).catch(e=>i(e))}),applyFilters=(e,t,r)=>filters.filter(t=>t.key===e).map(e=>e.cb(t,r)),addFilter=(e,t)=>filters.push({key:e,cb:t}),extendDefaultOptions=e=>Object.assign(defaultOptions,e),getOptions$1=()=>Object.assign({},defaultOptions),setOptions$1=e=>{forin(e,(e,t)=>{defaultOptions[e]&&(defaultOptions[e][0]=getValueByType(t,defaultOptions[e][0],defaultOptions[e][1]))})},defaultOptions={id:[null,Type.STRING],name:["filepond",Type.STRING],className:[null,Type.STRING],required:[!1,Type.BOOLEAN],captureMethod:[null,Type.STRING],allowDrop:[!0,Type.BOOLEAN],allowBrowse:[!0,Type.BOOLEAN],allowPaste:[!0,Type.BOOLEAN],allowMultiple:[!1,Type.BOOLEAN],allowReplace:[!0,Type.BOOLEAN],allowRevert:[!0,Type.BOOLEAN],forceRevert:[!1,Type.BOOLEAN],maxFiles:[null,Type.INT],checkValidity:[!1,Type.BOOLEAN],itemInsertLocation:["before",Type.STRING],itemInsertInterval:[75,Type.INT],dropOnPage:[!1,Type.BOOLEAN],dropOnElement:[!0,Type.BOOLEAN],dropValidation:[!1,Type.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],Type.ARRAY],instantUpload:[!0,Type.BOOLEAN],maxParallelUploads:[2,Type.INT],server:[null,Type.SERVER_API],labelDecimalSeparator:[getDecimalSeparator(),Type.STRING],labelThousandsSeparator:[getThousandsSeparator(),Type.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',Type.STRING],labelInvalidField:["Field contains invalid files",Type.STRING],labelFileWaitingForSize:["Waiting for size",Type.STRING],labelFileSizeNotAvailable:["Size not available",Type.STRING],labelFileCountSingular:["file in list",Type.STRING],labelFileCountPlural:["files in list",Type.STRING],labelFileLoading:["Loading",Type.STRING],labelFileAdded:["Added",Type.STRING],labelFileLoadError:["Error during load",Type.STRING],labelFileRemoved:["Removed",Type.STRING],labelFileRemoveError:["Error during remove",Type.STRING],labelFileProcessing:["Uploading",Type.STRING],labelFileProcessingComplete:["Upload complete",Type.STRING],labelFileProcessingAborted:["Upload cancelled",Type.STRING],labelFileProcessingError:["Error during upload",Type.STRING],labelFileProcessingRevertError:["Error during revert",Type.STRING],labelTapToCancel:["tap to cancel",Type.STRING],labelTapToRetry:["tap to retry",Type.STRING],labelTapToUndo:["tap to undo",Type.STRING],labelButtonRemoveItem:["Remove",Type.STRING],labelButtonAbortItemLoad:["Abort",Type.STRING],labelButtonRetryItemLoad:["Retry",Type.STRING],labelButtonAbortItemProcessing:["Cancel",Type.STRING],labelButtonUndoItemProcessing:["Undo",Type.STRING],labelButtonRetryItemProcessing:["Retry",Type.STRING],labelButtonProcessItem:["Upload",Type.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',Type.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',Type.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',Type.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',Type.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',Type.STRING],oninit:[null,Type.FUNCTION],onwarning:[null,Type.FUNCTION],onerror:[null,Type.FUNCTION],onaddfilestart:[null,Type.FUNCTION],onaddfileprogress:[null,Type.FUNCTION],onaddfile:[null,Type.FUNCTION],onprocessfilestart:[null,Type.FUNCTION],onprocessfileprogress:[null,Type.FUNCTION],onprocessfileabort:[null,Type.FUNCTION],onprocessfilerevert:[null,Type.FUNCTION],onprocessfile:[null,Type.FUNCTION],onremovefile:[null,Type.FUNCTION],onpreparefile:[null,Type.FUNCTION],onupdatefiles:[null,Type.FUNCTION],beforeAddFile:[null,Type.FUNCTION],beforeRemoveFile:[null,Type.FUNCTION],stylePanelLayout:[null,Type.STRING],stylePanelAspectRatio:[null,Type.STRING],styleItemPanelAspectRatio:[null,Type.STRING],styleButtonRemoveItemPosition:["left",Type.STRING],styleButtonProcessItemPosition:["right",Type.STRING],styleLoadIndicatorPosition:["right",Type.STRING],styleProgressIndicatorPosition:["right",Type.STRING],files:[[],Type.ARRAY]},getItemByQuery=(e,t)=>isEmpty(t)?e[0]||null:isInt(t)?e[t]||null:("object"==typeof t&&(t=t.id),e.find(e=>e.id===t)||null),getNumericAspectRatioFromString=e=>{if(isEmpty(e))return e;if(/:/.test(e)){const[t,r]=e.split(":");return r/t}return parseFloat(e)},getActiveItems=e=>e.filter(e=>!e.archived),queries=e=>({GET_ITEM:t=>getItemByQuery(e.items,t),GET_ACTIVE_ITEM:t=>getItemByQuery(getActiveItems(e.items),t),GET_ACTIVE_ITEMS:t=>getActiveItems(e.items),GET_ITEMS:t=>e.items,GET_ITEM_NAME:t=>{const r=getItemByQuery(e.items,t);return r?r.filename:null},GET_ITEM_SIZE:t=>{const r=getItemByQuery(e.items,t);return r?r.fileSize:null},GET_STYLES:()=>Object.keys(e.options).filter(e=>/^style/.test(e)).map(t=>({name:t,value:e.options[t]})),GET_PANEL_ASPECT_RATIO:()=>{return/circle/.test(e.options.stylePanelLayout)?1:getNumericAspectRatioFromString(e.options.stylePanelAspectRatio)},GET_ITEM_PANEL_ASPECT_RATIO:()=>e.options.styleItemPanelAspectRatio,GET_ITEMS_BY_STATUS:t=>getActiveItems(e.items).filter(e=>e.status===t),GET_TOTAL_ITEMS:()=>getActiveItems(e.items).length,IS_ASYNC:()=>isObject(e.options.server)&&(isObject(e.options.server.process)||isFunction(e.options.server.process))}),hasRoomForItem=e=>{const t=getActiveItems(e.items).length;if(!e.options.allowMultiple)return 0===t;const r=e.options.maxFiles;return null===r||t<r},limit=(e,t,r)=>Math.max(Math.min(r,e),t),arrayInsert=(e,t,r)=>e.splice(t,0,r),insertItem=(e,t,r)=>isEmpty(t)?null:void 0===r?(e.push(t),t):(r=limit(r,0,e.length),arrayInsert(e,r,t),t),isBase64DataURI=e=>/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(e),getFilenameFromURL=e=>e.split("/").pop().split("?").shift(),getExtensionFromFilename=e=>e.split(".").pop(),guesstimateExtension=e=>{if("string"!=typeof e)return"";const t=e.split("/").pop();return/svg/.test(t)?"svg":/zip|compressed/.test(t)?"zip":/plain/.test(t)?"txt":/msword/.test(t)?"doc":/[a-z]+/.test(t)?"jpeg"===t?"jpg":t:""},leftPad=(e,t="")=>(t+e).slice(-t.length),getDateString=(e=new Date)=>`${e.getFullYear()}-${leftPad(e.getMonth()+1,"00")}-${leftPad(e.getDate(),"00")}_${leftPad(e.getHours(),"00")}-${leftPad(e.getMinutes(),"00")}-${leftPad(e.getSeconds(),"00")}`,getFileFromBlob=(e,t,r=null,o=null)=>{const i="string"==typeof r?e.slice(0,e.size,r):e.slice(0,e.size,e.type);return i.lastModifiedDate=new Date,isString(t)||(t=getDateString()),t&&null===o&&getExtensionFromFilename(t)?i.name=t:(o=o||guesstimateExtension(i.type),i.name=t+(o?"."+o:"")),i},getBlobBuilder=()=>window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,createBlob=(e,t)=>{const r=getBlobBuilder();if(r){const o=new r;return o.append(e),o.getBlob(t)}return new Blob([e],{type:t})},getBlobFromByteStringWithMimeType=(e,t)=>{const r=new ArrayBuffer(e.length),o=new Uint8Array(r);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);return createBlob(r,t)},getMimeTypeFromBase64DataURI=e=>(/^data:(.+);/.exec(e)||[])[1]||null,getBase64DataFromBase64DataURI=e=>{return e.split(",")[1].replace(/\s/g,"")},getByteStringFromBase64DataURI=e=>atob(getBase64DataFromBase64DataURI(e)),getBlobFromBase64DataURI=e=>{const t=getMimeTypeFromBase64DataURI(e),r=getByteStringFromBase64DataURI(e);return getBlobFromByteStringWithMimeType(r,t)},getFileFromBase64DataURI=(e,t,r)=>getFileFromBlob(getBlobFromBase64DataURI(e),t,null,r),getFileNameFromHeader=e=>{const t=e.match(/(?:filename="(.+)")|(?:filename=(.+))/)||[];return t[1]||t[2]},getFileSizeFromHeader=e=>{if(/content-length:/i.test(e)){const t=e.match(/[0-9]+/)[0];return t?parseInt(t,10):null}return null},getTranfserIdFromHeader=e=>{if(/x-content-transfer-id:/i.test(e)){return(e.split(":")[1]||"").trim()||null}return null},getFileInfoFromHeaders=e=>{const t={source:null,name:null,size:null},r=e.split("\n");for(let e of r){const r=getFileNameFromHeader(e);if(r){t.name=r;continue}const o=getFileSizeFromHeader(e);if(o){t.size=o;continue}const i=getTranfserIdFromHeader(e);i&&(t.source=i)}return t},createFileLoader=e=>{const t={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},r=r=>{e?(t.timestamp=Date.now(),t.request=e(r,e=>{t.duration=Date.now()-t.timestamp,t.complete=!0,e instanceof Blob&&(e=getFileFromBlob(e,getFilenameFromURL(r))),o.fire("load",e instanceof Blob?e:e.body)},e=>{o.fire("error","string"==typeof e?{type:"error",code:0,body:e}:e)},(e,r,i)=>{i&&(t.size=i),t.duration=Date.now()-t.timestamp,e?(t.progress=r/i,o.fire("progress",t.progress)):t.progress=null},()=>{o.fire("abort")},e=>{const r=getFileInfoFromHeaders("string"==typeof e?e:e.headers);o.fire("meta",{size:t.size||r.size,filename:r.name,source:r.source})})):o.fire("error",{type:"error",body:"Can't load URL",code:400})},o=Object.assign({},on(),{setSource:e=>t.source=e,getProgress:()=>t.progress,abort:()=>{t.request&&t.request.abort()},load:()=>{const e=t.source;o.fire("init",e),e instanceof File?o.fire("load",e):e instanceof Blob?o.fire("load",getFileFromBlob(e,e.name)):isBase64DataURI(e)?o.fire("load",getFileFromBase64DataURI(e)):r(e)}});return o},isGet=e=>/GET|HEAD/.test(e),sendRequest=(e,t,r)=>{const o={onheaders:()=>{},onprogress:()=>{},onload:()=>{},ontimeout:()=>{},onerror:()=>{},onabort:()=>{},abort:()=>{i=!0,a.abort()}};let i=!1,n=!1;r=Object.assign({method:"POST",headers:{},withCredentials:!1},r),t=encodeURI(t),isGet(r.method)&&e&&(t=`${t}${encodeURIComponent("string"==typeof e?e:JSON.stringify(e))}`);const a=new XMLHttpRequest;return(isGet(r.method)?a:a.upload).onprogress=(e=>{i||o.onprogress(e.lengthComputable,e.loaded,e.total)}),a.onreadystatechange=(()=>{a.readyState<2||4===a.readyState&&0===a.status||n||(n=!0,o.onheaders(a))}),a.onload=(()=>{a.status>=200&&a.status<300?o.onload(a):o.onerror(a)}),a.onerror=(()=>o.onerror(a)),a.onabort=(()=>{i=!0,o.onabort()}),a.ontimeout=(()=>o.ontimeout(a)),a.open(r.method,t,!0),isInt(r.timeout)&&(a.timeout=r.timeout),Object.keys(r.headers).forEach(e=>{a.setRequestHeader(e,r.headers[e])}),r.responseType&&(a.responseType=r.responseType),r.withCredentials&&(a.withCredentials=!0),a.send(e),o},createResponse=(e,t,r,o)=>({type:e,code:t,body:r,headers:o}),createTimeoutResponse=e=>t=>{e(createResponse("error",0,"Timeout",t.getAllResponseHeaders()))},createFetchFunction=(e="",t)=>{if("function"==typeof t)return t;if(!t||!isString(t.url))return null;const r=t.onload||(e=>e),o=t.onerror||(e=>null);return(i,n,a,s,l,c)=>{const p=sendRequest(i,e+t.url,Object.assign({},t,{responseType:"blob"}));return p.onload=(e=>{const t=e.getAllResponseHeaders(),o=getFileInfoFromHeaders(t).name||getFilenameFromURL(i);n(createResponse("load",e.status,getFileFromBlob(r(e.response),o),t))}),p.onerror=(e=>{a(createResponse("error",e.status,o(e.response)||e.statusText,e.getAllResponseHeaders()))}),p.onheaders=(e=>{c(createResponse("headers",e.status,null,e.getAllResponseHeaders()))}),p.ontimeout=createTimeoutResponse(a),p.onprogress=s,p.onabort=l,p}},createProcessorFunction=(e="",t,r)=>"function"==typeof t?(...e)=>t(r,...e):t&&isString(t.url)?(o,i,n,a,s,l)=>{const c=t.ondata||(e=>e),p=t.onload||(e=>e),d=t.onerror||(e=>null);if(!o)return;var u=new FormData;isObject(i)&&u.append(r,JSON.stringify(i)),(o instanceof Blob?[{name:null,file:o}]:o).forEach(e=>{u.append(r,e.file,null===e.name?e.file.name:`${e.name}${e.file.name}`)});const m=sendRequest(c(u),e+t.url,t);return m.onload=(e=>{n(createResponse("load",e.status,p(e.response),e.getAllResponseHeaders()))}),m.onerror=(e=>{a(createResponse("error",e.status,d(e.response)||e.statusText,e.getAllResponseHeaders()))}),m.ontimeout=createTimeoutResponse(a),m.onprogress=s,m.onabort=l,m}:null,createRevertFunction=(e="",t)=>{if("function"==typeof t)return t;if(!t||!isString(t.url))return(e,t)=>t();const r=t.onload||(e=>e),o=t.onerror||(e=>null);return(i,n,a)=>{const s=sendRequest(i,e+t.url,t);return s.onload=(e=>{n(createResponse("load",e.status,r(e.response),e.getAllResponseHeaders()))}),s.onerror=(e=>{a(createResponse("error",e.status,o(e.response)||e.statusText,e.getAllResponseHeaders()))}),s.ontimeout=createTimeoutResponse(a),s}},getRandomNumber=(e=0,t=1)=>e+Math.random()*(t-e),createPerceivedPerformanceUpdater=(e,t=1e3,r=0,o=25,i=250)=>{let n=null;const a=Date.now(),s=()=>{let r=Date.now()-a,l=getRandomNumber(o,i);r+l>t&&(l=r+l-t);let c=r/t;c>=1?e(1):(e(c),n=setTimeout(s,l))};return s(),{clear:()=>{clearTimeout(n)}}},createFileProcessor=e=>{const t={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},r=()=>{t.request&&(t.perceivedPerformanceUpdater.clear(),t.request.abort(),t.complete=!0)},o=Object.assign({},on(),{process:(r,i)=>{const n=()=>{0!==t.duration&&null!==t.progress&&o.fire("progress",o.getProgress())},a=()=>{t.complete=!0,o.fire("load-perceived",t.response.body)};o.fire("start"),t.timestamp=Date.now(),t.perceivedPerformanceUpdater=createPerceivedPerformanceUpdater(e=>{t.perceivedProgress=e,t.perceivedDuration=Date.now()-t.timestamp,n(),t.response&&1===t.perceivedProgress&&!t.complete&&a()},getRandomNumber(750,1500)),t.request=e(r,i,e=>{t.response=isObject(e)?e:{type:"load",code:200,body:`${e}`,headers:{}},t.duration=Date.now()-t.timestamp,t.progress=1,o.fire("load",t.response.body),1===t.perceivedProgress&&a()},e=>{t.perceivedPerformanceUpdater.clear(),o.fire("error",isObject(e)?e:{type:"error",code:0,body:`${e}`})},(e,r,o)=>{t.duration=Date.now()-t.timestamp,t.progress=e?r/o:null,n()},()=>{t.perceivedPerformanceUpdater.clear(),o.fire("abort",t.response?t.response.body:null)})},abort:r,getProgress:()=>t.progress?Math.min(t.progress,t.perceivedProgress):null,getDuration:()=>Math.min(t.duration,t.perceivedDuration),reset:()=>{r(),t.complete=!1,t.perceivedProgress=0,t.progress=0,t.timestamp=null,t.perceivedDuration=0,t.duration=0,t.request=null,t.response=null}});return o},getFilenameWithoutExtension=e=>e.substr(0,e.lastIndexOf("."))||e,ItemStatus$1={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},createFileStub=e=>{let t=[e.name,e.size,e.type];return e instanceof Blob||isBase64DataURI(e)?t[0]=e.name||getDateString():isBase64DataURI(e)?(t[1]=e.length,t[2]=getMimeTypeFromBase64DataURI(e)):isString(e)&&(t[0]=getFilenameFromURL(e),t[1]=0,t[2]="application/octet-stream"),{name:t[0],size:t[1],type:t[2]}},FileOrigin$1={INPUT:1,LIMBO:2,LOCAL:3},deepCloneObject=e=>{if(!isObject(e))return e;const t=isArray(e)?[]:{};for(const r in e){if(!e.hasOwnProperty(r))continue;const o=e[r];t[r]=o&&isObject(o)?deepCloneObject(o):o}return t},createItem=(e=null,t=null,r=null)=>{const o=getUniqueId(),i={archived:!1,released:!1,source:null,file:r,serverFileReference:t,status:t?ItemStatus$1.PROCESSING_COMPLETE:ItemStatus$1.INIT,activeLoader:null,activeProcessor:null};let n=null;const a={},s=e=>i.status=e,l=(e,...t)=>{i.released||d.fire(e,...t)},c=(e,t)=>{if(s(ItemStatus$1.PROCESSING),n=null,!(i.file instanceof Blob))return void d.on("load",()=>{c(e,t)});e.on("load",e=>{i.serverFileReference=e}),e.on("load-perceived",e=>{i.activeProcessor=null,i.serverFileReference=e,s(ItemStatus$1.PROCESSING_COMPLETE),l("process-complete",e)}),e.on("start",()=>{l("process-start")}),e.on("error",e=>{i.activeProcessor=null,s(ItemStatus$1.PROCESSING_ERROR),l("process-error",e)}),e.on("abort",e=>{i.activeProcessor=null,i.serverFileReference=e,s(ItemStatus$1.IDLE),l("process-abort"),n&&n()}),e.on("progress",e=>{l("process-progress",e)});t(i.file,t=>{i.archived||e.process(t,Object.assign({},a))},e=>{}),i.activeProcessor=e},p=(e,t,r)=>{const o=e.split("."),i=o[0],n=o.pop();let s=a;o.forEach(e=>s=s[e]),JSON.stringify(s[n])!==JSON.stringify(t)&&(s[n]=t,r||l("metadata-update",{key:i,value:a[i]}))},d=Object.assign({id:{get:()=>o},origin:{get:()=>e},serverId:{get:()=>i.serverFileReference},status:{get:()=>i.status},filename:{get:()=>i.file.name},filenameWithoutExtension:{get:()=>getFilenameWithoutExtension(i.file.name)},fileExtension:{get:()=>getExtensionFromFilename(i.file.name)},fileType:{get:()=>i.file.type},fileSize:{get:()=>i.file.size},file:{get:()=>i.file},source:{get:()=>i.source},getMetadata:e=>deepCloneObject(e?a[e]:a),setMetadata:(e,t,r)=>{if(isObject(e)){const r=e;return Object.keys(r).forEach(e=>{p(e,r[e],t)}),e}return p(e,t,r),t},extend:(e,t)=>u[e]=t,abortLoad:()=>{i.activeLoader&&i.activeLoader.abort()},retryLoad:()=>{i.activeLoader&&i.activeLoader.load()},requestProcessing:()=>{s(ItemStatus$1.PROCESSING_QUEUED)},abortProcessing:()=>new Promise(e=>{if(!i.activeProcessor)return s(ItemStatus$1.IDLE),l("process-abort"),void e();n=(()=>{e()}),i.activeProcessor.abort()}),load:(t,r,o)=>{i.source=t,i.file?l("load-skip"):(i.file=createFileStub(t),r.on("init",()=>{l("load-init")}),r.on("meta",t=>{i.file.size=t.size,i.file.filename=t.filename,t.source&&(e=FileOrigin$1.LIMBO,i.serverFileReference=t.source,i.status=ItemStatus$1.PROCESSING_COMPLETE),l("load-meta")}),r.on("progress",e=>{s(ItemStatus$1.LOADING),l("load-progress",e)}),r.on("error",e=>{s(ItemStatus$1.LOAD_ERROR),l("load-request-error",e)}),r.on("abort",()=>{s(ItemStatus$1.INIT),l("load-abort")}),r.on("load",t=>{i.activeLoader=null;const r=t=>{i.file=t.size>0?t:i.file,s(e===FileOrigin$1.LIMBO&&i.serverFileReference?ItemStatus$1.PROCESSING_COMPLETE:ItemStatus$1.IDLE),l("load")};i.serverFileReference?r(t):o(t,r,e=>{i.file=t,l("load-meta"),s(ItemStatus$1.LOAD_ERROR),l("load-file-error",e)})}),r.setSource(t),i.activeLoader=r,r.load())},process:c,revert:(e,t)=>new Promise((r,o)=>{null!==i.serverFileReference?(e(i.serverFileReference,()=>{i.serverFileReference=null,r()},e=>{t?(s(ItemStatus$1.PROCESSING_REVERT_ERROR),l("process-revert-error"),o(e)):r()}),s(ItemStatus$1.IDLE),l("process-revert")):r()})},on(),{release:()=>i.released=!0,released:{get:()=>i.released},archive:()=>i.archived=!0,archived:{get:()=>i.archived}}),u=createObject(d);return u},getItemIndexByQuery=(e,t)=>isEmpty(t)?0:isString(t)?e.findIndex(e=>e.id===t):-1,getItemById=(e,t)=>{const r=getItemIndexByQuery(e,t);if(!(r<0))return e[r]||null},fetchLocal=(e,t,r,o,i,n)=>{const a=sendRequest(null,e,{method:"GET",responseType:"blob"});return a.onload=(r=>{const o=r.getAllResponseHeaders(),i=getFileInfoFromHeaders(o).name||getFilenameFromURL(e);t(createResponse("load",r.status,getFileFromBlob(r.response,i),o))}),a.onerror=(e=>{r(createResponse("error",e.status,e.statusText,e.getAllResponseHeaders()))}),a.onheaders=(e=>{n(createResponse("headers",e.status,null,e.getAllResponseHeaders()))}),a.ontimeout=createTimeoutResponse(r),a.onprogress=o,a.onabort=i,a},getDomainFromURL=e=>(0===e.indexOf("//")&&(e=location.protocol+e),e.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]),isExternalURL=e=>(e.indexOf(":")>-1||e.indexOf("//")>-1)&&getDomainFromURL(location.href)!==getDomainFromURL(e),isFile=e=>e instanceof File||e instanceof Blob&&e.name,dynamicLabel=e=>(...t)=>isFunction(e)?e(...t):e,isMockItem=e=>!isFile(e.file),listUpdated=(e,t)=>{clearTimeout(t.listUpdateTimeout),t.listUpdateTimeout=setTimeout(()=>{e("DID_UPDATE_ITEMS",{items:getActiveItems(t.items)})},0)},optionalPromise=(e,...t)=>new Promise(r=>{if(!e)return r(!0);const o=e(...t);return null==o?r(!0):"boolean"==typeof o?r(o):void("function"==typeof o.then&&o.then(r))}),sortItems=(e,t)=>{e.items.sort((e,r)=>t(createItemAPI(e),createItemAPI(r)))},getItemByQueryFromState=(e,t)=>({query:r,success:o=(()=>{}),failure:i=(()=>{})}={})=>{const n=getItemByQuery(e.items,r);n?t(n,o,i):i({error:createResponse("error",0,"Item not found"),file:null})},actions=(e,t,r)=>({ABORT_ALL:()=>{getActiveItems(r.items).forEach(e=>{e.abortLoad(),e.abortProcessing()})},DID_SET_FILES:({value:t=[]})=>{const o=t.map(e=>({source:e.source?e.source:e,options:e.options}));let i=getActiveItems(r.items);i.forEach(t=>{o.find(e=>e.source===t.source||e.source===t.file)||e("REMOVE_ITEM",{query:t})}),i=getActiveItems(r.items),o.forEach((t,r)=>{i.find(e=>e.source===t.source||e.file===t.source)||e("ADD_ITEM",Object.assign({},t,{interactionMethod:InteractionMethod.NONE,index:r}))})},DID_UPDATE_ITEM_METADATA:({id:o,change:i})=>{const n=getItemById(r.items,o);if(!t("IS_ASYNC"))return void applyFilterChain("SHOULD_PREPARE_OUTPUT",!1,{item:n,query:t}).then(t=>{t&&e("REQUEST_PREPARE_OUTPUT",{query:o,item:n,ready:t=>{e("DID_PREPARE_OUTPUT",{id:o,file:t})}},!0)});const a=()=>{setTimeout(()=>{e("REQUEST_ITEM_PROCESSING",{query:o})},32)};return n.status===ItemStatus$1.PROCESSING_COMPLETE?(e=>{n.revert(createRevertFunction(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(e?a:()=>{}).catch(()=>{})})(r.options.instantUpload):n.status===ItemStatus$1.PROCESSING?(e=>{n.abortProcessing().then(e?a:()=>{})})(r.options.instantUpload):void(r.options.instantUpload&&a())},SORT:({compare:e})=>{sortItems(r,e)},ADD_ITEMS:({items:r,index:o,interactionMethod:i,success:n=(()=>{}),failure:a=(()=>{})})=>{let s=o;if(-1===o||void 0===o){const e=t("GET_ITEM_INSERT_LOCATION"),r=t("GET_TOTAL_ITEMS");s="before"===e?0:r}const l=t("GET_IGNORED_FILES"),c=r.filter(e=>isFile(e)?!l.includes(e.name.toLowerCase()):!isEmpty(e)).map(t=>new Promise((r,o)=>{e("ADD_ITEM",{interactionMethod:i,source:t,success:r,failure:o,index:s++})}));Promise.all(c).then(n).catch(a)},ADD_ITEM:({source:o,index:i=-1,interactionMethod:n,success:a=(()=>{}),failure:s=(()=>{}),options:l={}})=>{if(isEmpty(o))return void s({error:createResponse("error",0,"No source"),file:null});if(isFile(o)&&r.options.ignoredFiles.includes(o.name.toLowerCase()))return;if(!hasRoomForItem(r)){if(r.options.allowMultiple||!r.options.allowMultiple&&!r.options.allowReplace){const t=createResponse("warning",0,"Max files");return e("DID_THROW_MAX_FILES",{source:o,error:t}),void s({error:t,file:null})}const c=getActiveItems(r.items)[0];if(c.status===ItemStatus$1.PROCESSING_COMPLETE||c.status===ItemStatus$1.PROCESSING_REVERT_ERROR){const p=t("GET_FORCE_REVERT");if(c.revert(createRevertFunction(r.options.server.url,r.options.server.revert),p).then(()=>{p&&e("ADD_ITEM",{source:o,index:i,interactionMethod:n,success:a,failure:s,options:l})}).catch(()=>{}),p)return}e("REMOVE_ITEM",{query:c.id})}const c="local"===l.type?FileOrigin$1.LOCAL:"limbo"===l.type?FileOrigin$1.LIMBO:FileOrigin$1.INPUT,p=createItem(c,c===FileOrigin$1.INPUT?null:o,l.file);Object.keys(l.metadata||{}).forEach(e=>{p.setMetadata(e,l.metadata[e])}),applyFilters("DID_CREATE_ITEM",p,{query:t,dispatch:e}),insertItem(r.items,p,i);const d=t("GET_ITEM_INSERT_LOCATION");isFunction(d)&&o&&sortItems(r,d);const u=p.id;p.on("load-init",()=>{e("DID_START_ITEM_LOAD",{id:u})}),p.on("load-meta",()=>{e("DID_UPDATE_ITEM_META",{id:u})}),p.on("load-progress",t=>{e("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:u,progress:t})}),p.on("load-request-error",t=>{const o=dynamicLabel(r.options.labelFileLoadError)(t);if(t.code>=400&&t.code<500)return e("DID_THROW_ITEM_INVALID",{id:u,error:t,status:{main:o,sub:`${t.code} (${t.body})`}}),void s({error:t,file:createItemAPI(p)});e("DID_THROW_ITEM_LOAD_ERROR",{id:u,error:t,status:{main:o,sub:r.options.labelTapToRetry}})}),p.on("load-file-error",t=>{e("DID_THROW_ITEM_INVALID",Object.assign({},t,{id:u}))}),p.on("load-abort",()=>{e("REMOVE_ITEM",{query:u})}),p.on("load-skip",()=>{e("COMPLETE_LOAD_ITEM",{query:u,item:p,data:{source:o,success:a}})}),p.on("load",()=>{const i=i=>{i?(p.on("metadata-update",t=>{e("DID_UPDATE_ITEM_METADATA",{id:u,change:t})}),applyFilterChain("SHOULD_PREPARE_OUTPUT",!1,{item:p,query:t}).then(t=>{const i=()=>{e("COMPLETE_LOAD_ITEM",{query:u,item:p,data:{source:o,success:a}}),listUpdated(e,r)};t?e("REQUEST_PREPARE_OUTPUT",{query:u,item:p,ready:t=>{e("DID_PREPARE_OUTPUT",{id:u,file:t}),i()}},!0):i()})):e("REMOVE_ITEM",{query:u})};applyFilterChain("DID_LOAD_ITEM",p,{query:t,dispatch:e}).then(()=>{optionalPromise(t("GET_BEFORE_ADD_FILE"),createItemAPI(p)).then(i)}).catch(()=>{i(!1)})}),p.on("process-start",()=>{e("DID_START_ITEM_PROCESSING",{id:u})}),p.on("process-progress",t=>{e("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:u,progress:t})}),p.on("process-error",t=>{e("DID_THROW_ITEM_PROCESSING_ERROR",{id:u,error:t,status:{main:dynamicLabel(r.options.labelFileProcessingError)(t),sub:r.options.labelTapToRetry}})}),p.on("process-revert-error",t=>{e("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:u,error:t,status:{main:dynamicLabel(r.options.labelFileProcessingRevertError)(t),sub:r.options.labelTapToRetry}})}),p.on("process-complete",t=>{e("DID_COMPLETE_ITEM_PROCESSING",{id:u,error:null,serverFileReference:t})}),p.on("process-abort",()=>{e("DID_ABORT_ITEM_PROCESSING",{id:u})}),p.on("process-revert",()=>{e("DID_REVERT_ITEM_PROCESSING",{id:u})}),e("DID_ADD_ITEM",{id:u,index:i,interactionMethod:n}),listUpdated(e,r);const{url:m,load:E,restore:I,fetch:T}=r.options.server||{};p.load(o,createFileLoader(c===FileOrigin$1.INPUT?isString(o)&&isExternalURL(o)?createFetchFunction(m,T):fetchLocal:c===FileOrigin$1.LIMBO?createFetchFunction(m,I):createFetchFunction(m,E)),(e,r,o)=>{applyFilterChain("LOAD_FILE",e,{query:t}).then(r).catch(o)})},REQUEST_PREPARE_OUTPUT:({item:e,ready:r})=>{applyFilterChain("PREPARE_OUTPUT",e.file,{query:t,item:e}).then(o=>{applyFilterChain("COMPLETE_PREPARE_OUTPUT",o,{query:t,item:e}).then(e=>{r(e)})})},COMPLETE_LOAD_ITEM:({item:o,data:i})=>{const{success:n,source:a}=i,s=t("GET_ITEM_INSERT_LOCATION");isFunction(s)&&a&&sortItems(r,s),e("DID_LOAD_ITEM",{id:o.id,error:null,serverFileReference:o.origin===FileOrigin$1.INPUT?null:a}),n(createItemAPI(o)),o.origin!==FileOrigin$1.LOCAL?o.origin!==FileOrigin$1.LIMBO?t("IS_ASYNC")&&r.options.instantUpload&&e("REQUEST_ITEM_PROCESSING",{query:o.id}):e("DID_COMPLETE_ITEM_PROCESSING",{id:o.id,error:null,serverFileReference:a}):e("DID_LOAD_LOCAL_ITEM",{id:o.id})},RETRY_ITEM_LOAD:getItemByQueryFromState(r,e=>{e.retryLoad()}),REQUEST_ITEM_PROCESSING:getItemByQueryFromState(r,(o,i,n)=>{if(o.status===ItemStatus$1.IDLE||o.status===ItemStatus$1.PROCESSING_ERROR)o.status!==ItemStatus$1.PROCESSING_QUEUED&&(o.requestProcessing(),e("DID_REQUEST_ITEM_PROCESSING",{id:o.id}),e("PROCESS_ITEM",{query:o,success:i,failure:n},!0));else{const a=()=>{setTimeout(()=>{e("REQUEST_ITEM_PROCESSING",{query:o,success:i,failure:n})},32)};o.status===ItemStatus$1.PROCESSING_COMPLETE||o.status===ItemStatus$1.PROCESSING_REVERT_ERROR?o.revert(createRevertFunction(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(a).catch(()=>{}):o.status===ItemStatus$1.PROCESSING&&o.abortProcessing().then(a)}}),PROCESS_ITEM:getItemByQueryFromState(r,(o,i,n)=>{const a=t("GET_MAX_PARALLEL_UPLOADS");t("GET_ITEMS_BY_STATUS",ItemStatus$1.PROCESSING).length!==a?o.status!==ItemStatus$1.PROCESSING&&(o.onOnce("process-complete",()=>{i(createItemAPI(o));const t=r.processingQueue.shift();t&&e("PROCESS_ITEM",{query:t.item,success:t.success,failure:t.failure},!0)}),o.onOnce("process-error",e=>{n({error:e,file:createItemAPI(o)})}),o.process(createFileProcessor(createProcessorFunction(r.options.server.url,r.options.server.process,r.options.name)),(r,i,n)=>{applyFilterChain("PREPARE_OUTPUT",r,{query:t,item:o}).then(t=>{e("DID_PREPARE_OUTPUT",{id:o.id,file:t}),i(t)}).catch(n)})):r.processingQueue.push({item:o,success:i,failure:n})}),RETRY_ITEM_PROCESSING:getItemByQueryFromState(r,t=>{e("REQUEST_ITEM_PROCESSING",{query:t})}),REQUEST_REMOVE_ITEM:getItemByQueryFromState(r,r=>{optionalPromise(t("GET_BEFORE_REMOVE_FILE"),createItemAPI(r)).then(t=>{t&&e("REMOVE_ITEM",{query:r})})}),RELEASE_ITEM:getItemByQueryFromState(r,e=>{e.release()}),REMOVE_ITEM:getItemByQueryFromState(r,(t,o)=>{const i=()=>{const i=t.id;getItemById(r.items,i).archive(),e("DID_REMOVE_ITEM",{id:i,item:t}),listUpdated(e,r),o(createItemAPI(t))},n=r.options.server;t.origin===FileOrigin$1.LOCAL&&n&&isFunction(n.remove)?(e("DID_START_ITEM_REMOVE",{id:t.id}),n.remove(t.source,()=>i(),o=>{e("DID_THROW_ITEM_REMOVE_ERROR",{id:t.id,error:createResponse("error",0,o,null),status:{main:dynamicLabel(r.options.labelFileRemoveError)(o),sub:r.options.labelTapToRetry}})})):i()}),ABORT_ITEM_LOAD:getItemByQueryFromState(r,e=>{e.abortLoad()}),ABORT_ITEM_PROCESSING:getItemByQueryFromState(r,t=>{t.serverId?e("REVERT_ITEM_PROCESSING",{id:t.id}):t.abortProcessing().then(()=>{r.options.instantUpload&&e("REMOVE_ITEM",{query:t.id})})}),REQUEST_REVERT_ITEM_PROCESSING:getItemByQueryFromState(r,o=>{if(!r.options.instantUpload)return void e("REVERT_ITEM_PROCESSING",{query:o});const i=t=>{t&&e("REVERT_ITEM_PROCESSING",{query:o})},n=t("GET_BEFORE_REMOVE_FILE");if(!n)return i(!0);const a=n(createItemAPI(o));return null==a?i(!0):"boolean"==typeof a?i(a):void("function"==typeof a.then&&a.then(i))}),REVERT_ITEM_PROCESSING:getItemByQueryFromState(r,o=>{o.revert(createRevertFunction(r.options.server.url,r.options.server.revert),t("GET_FORCE_REVERT")).then(()=>{(r.options.instantUpload||isMockItem(o))&&e("REMOVE_ITEM",{query:o.id})}).catch(()=>{})}),SET_OPTIONS:({options:t})=>{forin(t,(t,r)=>{e(`SET_${fromCamels(t,"_").toUpperCase()}`,{value:r})})}}),formatFilename=e=>e,createElement$1=e=>document.createElement(e),text=(e,t)=>{let r=e.childNodes[0];r?t!==r.nodeValue&&(r.nodeValue=t):(r=document.createTextNode(t),e.appendChild(r))},polarToCartesian=(e,t,r,o)=>{const i=(o%360-90)*Math.PI/180;return{x:e+r*Math.cos(i),y:t+r*Math.sin(i)}},describeArc=(e,t,r,o,i,n)=>{const a=polarToCartesian(e,t,r,i),s=polarToCartesian(e,t,r,o);return["M",a.x,a.y,"A",r,r,0,n,0,s.x,s.y].join(" ")},percentageArc=(e,t,r,o,i)=>{let n=1;return i>o&&i-o<=.5&&(n=0),o>i&&o-i>=.5&&(n=0),describeArc(e,t,r,360*Math.min(.9999,o),360*Math.min(.9999,i),n)},create$7=({root:e,props:t})=>{t.spin=!1,t.progress=0,t.opacity=0;const r=createElement("svg");e.ref.path=createElement("path",{"stroke-width":2,"stroke-linecap":"round"}),r.appendChild(e.ref.path),e.ref.svg=r,e.appendChild(r)},write$5=({root:e,props:t})=>{if(0===t.opacity)return;t.align&&(e.element.dataset.align=t.align);const r=parseInt(attr(e.ref.path,"stroke-width"),10),o=.5*e.rect.element.width;let i=0,n=0;t.spin?(i=0,n=.5):(i=0,n=t.progress);const a=percentageArc(o,o,o-r,i,n);attr(e.ref.path,"d",a),attr(e.ref.path,"stroke-opacity",t.spin||t.progress>0?1:0)},progressIndicator=createView({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:create$7,write:write$5,mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),create$8=({root:e,props:t})=>{e.element.title=t.label,e.element.innerHTML=t.icon||"",t.disabled=!1},write$6=({root:e,props:t})=>{0!==t.opacity||t.disabled?t.opacity>0&&t.disabled&&(t.disabled=!1,e.element.removeAttribute("disabled")):(t.disabled=!0,attr(e.element,"disabled","disabled"))},fileActionButton=createView({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:create$8,write:write$6}),toNaturalFileSize=(e,t=".")=>(e=Math.round(Math.abs(e)))<1e3?`${e} bytes`:e<MB?`${Math.floor(e/KB)} KB`:e<GB?`${removeDecimalsWhenZero(e/MB,1,t)} MB`:`${removeDecimalsWhenZero(e/GB,2,t)} GB`,KB=1e3,MB=1e6,GB=1e9,removeDecimalsWhenZero=(e,t,r)=>e.toFixed(t).split(".").filter(e=>"0"!==e).join(r),create$9=({root:e,props:t})=>{const r=createElement$1("span");r.className="filepond--file-info-main",attr(r,"aria-hidden","true"),e.appendChild(r),e.ref.fileName=r;const o=createElement$1("span");o.className="filepond--file-info-sub",e.appendChild(o),e.ref.fileSize=o,text(o,e.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),text(r,formatFilename(e.query("GET_ITEM_NAME",t.id)))},updateFile=({root:e,props:t})=>{text(e.ref.fileSize,toNaturalFileSize(e.query("GET_ITEM_SIZE",t.id))),text(e.ref.fileName,formatFilename(e.query("GET_ITEM_NAME",t.id)))},updateFileSizeOnError=({root:e,props:t})=>{isInt(e.query("GET_ITEM_SIZE",t.id))||text(e.ref.fileSize,e.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},fileInfo=createView({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:createRoute({DID_LOAD_ITEM:updateFile,DID_UPDATE_ITEM_META:updateFile,DID_THROW_ITEM_LOAD_ERROR:updateFileSizeOnError,DID_THROW_ITEM_INVALID:updateFileSizeOnError}),didCreateView:e=>{applyFilters("CREATE_VIEW",Object.assign({},e,{view:e}))},create:create$9,mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),toPercentage=e=>Math.round(100*e),create$10=({root:e,props:t})=>{const r=createElement$1("span");r.className="filepond--file-status-main",e.appendChild(r),e.ref.main=r;const o=createElement$1("span");o.className="filepond--file-status-sub",e.appendChild(o),e.ref.sub=o,didSetItemLoadProgress({root:e,action:{progress:null}})},didSetItemLoadProgress=({root:e,action:t})=>{const r=null===t.progress?e.query("GET_LABEL_FILE_LOADING"):`${e.query("GET_LABEL_FILE_LOADING")} ${toPercentage(t.progress)}%`;text(e.ref.main,r),text(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},didSetItemProcessProgress=({root:e,action:t})=>{const r=null===t.progress?e.query("GET_LABEL_FILE_PROCESSING"):`${e.query("GET_LABEL_FILE_PROCESSING")} ${toPercentage(t.progress)}%`;text(e.ref.main,r),text(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},didRequestItemProcessing=({root:e})=>{text(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING")),text(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},didAbortItemProcessing=({root:e})=>{text(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_ABORTED")),text(e.ref.sub,e.query("GET_LABEL_TAP_TO_RETRY"))},didCompleteItemProcessing$1=({root:e})=>{text(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),text(e.ref.sub,e.query("GET_LABEL_TAP_TO_UNDO"))},clear=({root:e})=>{text(e.ref.main,""),text(e.ref.sub,"")},error=({root:e,action:t})=>{text(e.ref.main,t.status.main),text(e.ref.sub,t.status.sub)},fileStatus=createView({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:createRoute({DID_LOAD_ITEM:clear,DID_REVERT_ITEM_PROCESSING:clear,DID_REQUEST_ITEM_PROCESSING:didRequestItemProcessing,DID_ABORT_ITEM_PROCESSING:didAbortItemProcessing,DID_COMPLETE_ITEM_PROCESSING:didCompleteItemProcessing$1,DID_UPDATE_ITEM_PROCESS_PROGRESS:didSetItemProcessProgress,DID_UPDATE_ITEM_LOAD_PROGRESS:didSetItemLoadProgress,DID_THROW_ITEM_LOAD_ERROR:error,DID_THROW_ITEM_INVALID:error,DID_THROW_ITEM_PROCESSING_ERROR:error,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:error,DID_THROW_ITEM_REMOVE_ERROR:error}),didCreateView:e=>{applyFilters("CREATE_VIEW",Object.assign({},e,{view:e}))},create:create$10,mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),Buttons={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},ButtonKeys=[];forin(Buttons,e=>{ButtonKeys.push(e)});const calculateFileInfoOffset=e=>e.ref.buttonRemoveItem.rect.element.width+e.ref.buttonRemoveItem.rect.element.left,calculateFileVerticalCenterOffset=e=>Math.floor(e.ref.buttonRemoveItem.rect.element.height/4),calculateFileHorizontalCenterOffset=e=>Math.floor(e.ref.buttonRemoveItem.rect.element.left/2),getLoadIndicatorAlignment=e=>e.query("GET_STYLE_LOAD_INDICATOR_POSITION"),getProcessIndicatorAlignment=e=>e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION"),getRemoveIndicatorAligment=e=>e.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION"),DefaultStyle={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:getLoadIndicatorAlignment},processProgressIndicator:{opacity:0,align:getProcessIndicatorAlignment},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},IdleStyle={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset}},ProcessingStyle={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},StyleMap={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:getRemoveIndicatorAligment},info:{translateX:calculateFileInfoOffset},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:getRemoveIndicatorAligment},buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1,translateX:calculateFileInfoOffset}},DID_LOAD_ITEM:IdleStyle,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{translateX:calculateFileInfoOffset}},DID_START_ITEM_PROCESSING:ProcessingStyle,DID_REQUEST_ITEM_PROCESSING:ProcessingStyle,DID_UPDATE_ITEM_PROCESS_PROGRESS:ProcessingStyle,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:calculateFileInfoOffset}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:calculateFileInfoOffset},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:IdleStyle},processingCompleteIndicatorView=createView({create:({root:e})=>{e.element.innerHTML=e.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),create$6=({root:e,props:t})=>{const{id:r}=t,o=e.query("GET_ALLOW_REVERT"),i=e.query("GET_INSTANT_UPLOAD"),n=e.query("IS_ASYNC"),a=n?ButtonKeys.concat():ButtonKeys.filter(e=>!/Process/.test(e));if(n&&!o){a.splice(-1,1);const e=StyleMap.DID_COMPLETE_ITEM_PROCESSING;e.info.translateX=calculateFileHorizontalCenterOffset,e.info.translateY=calculateFileVerticalCenterOffset,e.status.translateY=calculateFileVerticalCenterOffset,e.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}i&&o&&(Buttons.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",Buttons.RevertItemProcessing.icon="GET_ICON_REMOVE"),forin(Buttons,(t,o)=>{const i=e.createChildView(fileActionButton,{label:e.query(o.label),icon:e.query(o.icon),opacity:0});a.includes(t)&&e.appendChildView(i),i.element.dataset.align=e.query(`GET_STYLE_${o.align}`),i.element.classList.add(o.className),i.on("click",()=>{e.dispatch(o.action,{query:r})}),e.ref[`button${t}`]=i}),e.ref.info=e.appendChildView(e.createChildView(fileInfo,{id:r})),e.ref.status=e.appendChildView(e.createChildView(fileStatus,{id:r})),e.ref.processingCompleteIndicator=e.appendChildView(e.createChildView(processingCompleteIndicatorView)),e.ref.processingCompleteIndicator.element.dataset.align=e.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION");const s=e.appendChildView(e.createChildView(progressIndicator,{opacity:0,align:e.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));s.element.classList.add("filepond--load-indicator"),e.ref.loadProgressIndicator=s;const l=e.appendChildView(e.createChildView(progressIndicator,{opacity:0,align:e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));l.element.classList.add("filepond--process-indicator"),e.ref.processProgressIndicator=l},write$4=({root:e,actions:t,props:r})=>{route$4({root:e,actions:t,props:r});let o=[...t].filter(e=>/^DID_/.test(e.type)).reverse().find(e=>StyleMap[e.type]);if(!o||o&&o.type===e.ref.currentAction)return;e.ref.currentAction=o.type;const i=StyleMap[e.ref.currentAction];forin(DefaultStyle,(t,r)=>{const o=e.ref[t];forin(r,(r,n)=>{const a=i[t]&&void 0!==i[t][r]?i[t][r]:n;o[r]="function"==typeof a?a(e):a})})},route$4=createRoute({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:({root:e,action:t})=>{e.ref.buttonAbortItemProcessing.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:({root:e,action:t})=>{e.ref.buttonAbortItemLoad.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:({root:e,action:t})=>{e.ref.buttonAbortItemRemoval.label=t.value},DID_REQUEST_ITEM_PROCESSING:({root:e})=>{e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:({root:e})=>{e.ref.loadProgressIndicator.spin=!0,e.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:({root:e})=>{e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:({root:e,action:t})=>{e.ref.loadProgressIndicator.spin=!1,e.ref.loadProgressIndicator.progress=t.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:({root:e,action:t})=>{e.ref.processProgressIndicator.spin=!1,e.ref.processProgressIndicator.progress=t.progress}}),file=createView({create:create$6,write:write$4,didCreateView:e=>{applyFilters("CREATE_VIEW",Object.assign({},e,{view:e}))},name:"file"}),create$5=({root:e,props:t})=>{e.ref.fileName=createElement$1("legend"),e.appendChild(e.ref.fileName),e.ref.file=e.appendChildView(e.createChildView(file,{id:t.id}));const r=createElement$1("input");r.type="hidden",r.name=e.query("GET_NAME"),e.ref.data=r,e.appendChild(r)},didLoadItem=({root:e,action:t,props:r})=>{e.ref.data.value=t.serverFileReference,text(e.ref.fileName,formatFilename(e.query("GET_ITEM_NAME",r.id)))},didRemoveItem=({root:e})=>{e.ref.data.removeAttribute("value")},didCompleteItemProcessing=({root:e,action:t})=>{e.ref.data.value=t.serverFileReference},didRevertItemProcessing=({root:e,action:t})=>{e.ref.data.removeAttribute("value")},fileWrapper=createView({create:create$5,ignoreRect:!0,write:createRoute({DID_LOAD_ITEM:didLoadItem,DID_REMOVE_ITEM:didRemoveItem,DID_COMPLETE_ITEM_PROCESSING:didCompleteItemProcessing,DID_REVERT_ITEM_PROCESSING:didRevertItemProcessing}),didCreateView:e=>{applyFilters("CREATE_VIEW",Object.assign({},e,{view:e}))},tag:"fieldset",name:"file-wrapper"}),PANEL_SPRING_PROPS={type:"spring",damping:.6,mass:7},create$11=({root:e,props:t})=>{[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:PANEL_SPRING_PROPS},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:PANEL_SPRING_PROPS},styles:["translateY"]}}].forEach(r=>{createSection(e,r,t.name)}),e.element.classList.add(`filepond--${t.name}`),e.ref.scalable=null},createSection=(e,t,r)=>{const o=createView({name:`panel-${t.name} filepond--${r}`,mixins:t.mixins,ignoreRectUpdate:!0}),i=e.createChildView(o,t.props);e.ref[t.name]=e.appendChildView(i)},write$7=({root:e,props:t})=>{if(null!==e.ref.scalable&&t.scalable===e.ref.scalable||(e.ref.scalable=!isBoolean(t.scalable)||t.scalable,e.element.dataset.scalable=e.ref.scalable),!t.height)return;const r=e.ref.top.rect.element,o=e.ref.bottom.rect.element,i=Math.max(r.height+o.height,t.height);e.ref.center.translateY=r.height,e.ref.center.scaleY=(i-r.height-o.height)/100,e.ref.bottom.translateY=i-o.height},panel=createView({name:"panel",write:write$7,create:create$11,ignoreRect:!0,mixins:{apis:["height","scalable"]}}),ITEM_TRANSLATE_SPRING={type:"spring",stiffness:.75,damping:.45,mass:10},ITEM_SCALE_SPRING="spring",create$4=({root:e,props:t})=>{e.element.id=`filepond--item-${t.id}`,e.ref.container=e.appendChildView(e.createChildView(fileWrapper,{id:t.id})),e.ref.panel=e.appendChildView(e.createChildView(panel,{name:"item-panel"})),e.ref.panel.height=0,t.markedForRemoval=!1},StateMap={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy",DID_REQUEST_ITEM_PROCESSING:"busy",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},route$3=createRoute({DID_UPDATE_PANEL_HEIGHT:({root:e,action:t})=>{const{height:r}=t;e.height=r}}),write$3=({root:e,actions:t,props:r,shouldOptimize:o})=>{const i=e.query("GET_ITEM_PANEL_ASPECT_RATIO")||e.query("GET_PANEL_ASPECT_RATIO");i?o||(e.height=e.rect.element.width*i):(route$3({root:e,actions:t,props:r}),e.height||(e.height=e.ref.container.rect.element.height)),o&&(e.ref.panel.height=null),e.ref.panel.height=e.height;let n=[...t].filter(e=>/^DID_/.test(e.type)).reverse().find(e=>StateMap[e.type]);!n||n&&n.type===r.currentState||(r.currentState=n.type,e.element.dataset.filepondItemState=StateMap[r.currentState]||"")},item=createView({create:create$4,write:write$3,destroy:({root:e,props:t})=>{e.dispatch("RELEASE_ITEM",{query:t.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:"spring",scaleY:"spring",translateX:ITEM_TRANSLATE_SPRING,translateY:ITEM_TRANSLATE_SPRING,opacity:{type:"tween",duration:150}}}}),getItemIndexByPosition=(e,t)=>{if(!t)return;const r=e.rect.element.width,o=e.childViews,i=o.length;let n=null;if(0===i||t.top<o[0].rect.element.top)return-1;const a=o[0].rect.element,s=a.marginLeft+a.marginRight,l=a.width+s,c=Math.round(r/l);if(1===c){for(let e=0;e<i;e++){const r=o[e],i=r.rect.outer.top+.5*r.rect.element.height;if(t.top<i)return e}return i}const p=a.marginTop+a.marginBottom,d=a.height+p;for(let e=0;e<i;e++){const r=e%c*l,o=Math.floor(e/c)*d,s=o-a.marginTop,p=r+l,u=o+d+a.marginBottom;if(t.top<u&&t.top>s){if(t.left<p)return e;n=e!==i-1?e:null}}return null!==n?n:i},create$3=({root:e,props:t})=>{attr(e.element,"role","list"),e.ref.lastItemSpanwDate=Date.now()},addItemView=({root:e,action:t})=>{const{id:r,index:o,interactionMethod:i}=t;e.ref.addIndex=o;const n=Date.now();let a=n,s=1;if(i!==InteractionMethod.NONE){s=0;const t=e.query("GET_ITEM_INSERT_INTERVAL"),r=n-e.ref.lastItemSpanwDate;a=r<t?n+(t-r):n}e.ref.lastItemSpanwDate=a,e.appendChildView(e.createChildView(item,{spawnDate:a,id:r,opacity:s,interactionMethod:i}),o)},moveItem=(e,t,r,o=0,i=1)=>{e.translateX=t,e.translateY=r,Date.now()>e.spawnDate&&(0===e.opacity&&introItemView(e,t,r,o,i),e.scaleX=1,e.scaleY=1,e.opacity=1)},introItemView=(e,t,r,o,i)=>{e.interactionMethod===InteractionMethod.NONE?(e.translateX=null,e.translateX=t,e.translateY=null,e.translateY=r):e.interactionMethod===InteractionMethod.DROP?(e.translateX=null,e.translateX=t-20*o,e.translateY=null,e.translateY=r-10*i,e.scaleX=.8,e.scaleY=.8):e.interactionMethod===InteractionMethod.BROWSE?(e.translateY=null,e.translateY=r-30):e.interactionMethod===InteractionMethod.API&&(e.translateX=null,e.translateX=t-30,e.translateY=null)},removeItemView=({root:e,action:t})=>{const{id:r}=t,o=e.childViews.find(e=>e.id===r);o&&(o.scaleX=.9,o.scaleY=.9,o.opacity=0,o.markedForRemoval=!0)},route$2=createRoute({DID_ADD_ITEM:addItemView,DID_REMOVE_ITEM:removeItemView}),write$2=({root:e,props:t,actions:r,shouldOptimize:o})=>{route$2({root:e,props:t,actions:r});const{dragCoordinates:i}=t,n=i?getItemIndexByPosition(e,i):null,a=e.rect.element.width,s=e.childViews.filter(e=>e.rect.outer.height),l=e.query("GET_ACTIVE_ITEMS").map(e=>s.find(t=>t.id===e.id)).filter(e=>e),c=e.ref.addIndex||null;e.ref.addIndex=null;let p=0,d=0,u=0;if(0===l.length)return;const m=l[0].rect.element,E=m.marginTop+m.marginBottom,I=m.marginLeft+m.marginRight,T=m.width+I,g=m.height+E,f=Math.round(a/T);if(1===f){let e=0,t=0;l.forEach((r,i)=>{if(n){let e=i-n;t=-2===e?.25*-E:-1===e?.75*-E:0===e?.75*E:1===e?.25*E:0}o&&(r.translateX=null,r.translateY=null),r.markedForRemoval||moveItem(r,0,e+t);let a=(r.rect.element.height+E)*(r.markedForRemoval?r.opacity:1);e+=a})}else{let e=0,t=0;l.forEach((r,i)=>{i===n&&(p=1),i===c&&(u+=1),r.markedForRemoval&&r.opacity<.5&&(d-=1);const a=i+u+p+d,s=a%f,l=Math.floor(a/f),m=s*T,E=l*g,I=Math.sign(m-e),_=Math.sign(E-t);e=m,t=E,r.markedForRemoval||(o&&(r.translateX=null,r.translateY=null),moveItem(r,m,E,I,_))})}},filterSetItemActions=(e,t)=>t.filter(t=>!t.data||!t.data.id||e.id===t.data.id),list=createView({create:create$3,write:write$2,tag:"ul",name:"list",didWriteView:({root:e})=>{e.childViews.filter(e=>e.markedForRemoval&&0===e.opacity&&e.resting).forEach(t=>{t._destroy(),e.removeChildView(t)})},filterFrameActionsForChild:filterSetItemActions,mixins:{apis:["dragCoordinates"]}}),create$2=({root:e,props:t})=>{e.ref.list=e.appendChildView(e.createChildView(list)),t.dragCoordinates=null,t.overflowing=!1},storeDragCoordinates=({root:e,props:t,action:r})=>{t.dragCoordinates={left:r.position.scopeLeft-e.ref.list.rect.element.left,top:r.position.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)}},clearDragCoordinates=({props:e})=>{e.dragCoordinates=null},route$1=createRoute({DID_DRAG:storeDragCoordinates,DID_END_DRAG:clearDragCoordinates}),write$1=({root:e,props:t,actions:r})=>{if(route$1({root:e,props:t,actions:r}),e.ref.list.dragCoordinates=t.dragCoordinates,t.overflowing&&!t.overflow&&(t.overflowing=!1,e.element.dataset.state="",e.height=null),t.overflow){const r=Math.round(t.overflow);r!==e.height&&(t.overflowing=!0,e.element.dataset.state="overflow",e.height=r)}},listScroller=createView({create:create$2,write:write$1,name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),attrToggle=(e,t,r,o="")=>{r?attr(e,t,o):e.removeAttribute(t)},resetFileInput=e=>{if(e&&""!==e.value){try{e.value=""}catch(e){}if(e.value){const t=createElement$1("form"),r=e.parentNode,o=e.nextSibling;t.appendChild(e),t.reset(),o?r.insertBefore(e,o):r.appendChild(e)}}},create$12=({root:e,props:t})=>{e.element.id=`filepond--browser-${t.id}`,attr(e.element,"aria-controls",`filepond--assistant-${t.id}`),attr(e.element,"aria-labelledby",`filepond--drop-label-${t.id}`),e.ref.handleChange=(r=>{if(!e.element.value)return;const o=[...e.element.files];setTimeout(()=>{t.onload(o),resetFileInput(e.element)},250)}),e.element.addEventListener("change",e.ref.handleChange)},setAcceptedFileTypes=({root:e,action:t})=>{attrToggle(e.element,"accept",!!t.value,t.value?t.value.join(","):"")},toggleAllowMultiple=({root:e,action:t})=>{attrToggle(e.element,"multiple",t.value)},toggleAllowBrowse$1=({root:e,action:t})=>{attrToggle(e.element,"disabled",!t.value)},toggleRequired=({root:e,action:t})=>{t.value?0===e.query("GET_TOTAL_ITEMS")&&attrToggle(e.element,"required",!0):attrToggle(e.element,"required",!1)},setCaptureMethod=({root:e,action:t})=>{attrToggle(e.element,"capture",!!t.value,!0===t.value?"":t.value)},updateRequiredStatus=({root:e,props:t})=>{if(e.query("GET_TOTAL_ITEMS")>0)attrToggle(e.element,"required",!1);else{e.query("GET_CHECK_VALIDITY")&&e.element.setCustomValidity(""),e.query("GET_REQUIRED")&&attrToggle(e.element,"required",!0)}},updateFieldValidityStatus=({root:e})=>{e.query("GET_CHECK_VALIDITY")&&e.element.setCustomValidity(e.query("GET_LABEL_INVALID_FIELD"))},browser=createView({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:create$12,destroy:({root:e})=>{e.element.removeEventListener("change",e.ref.handleChange)},write:createRoute({DID_LOAD_ITEM:updateRequiredStatus,DID_THROW_ITEM_INVALID:updateFieldValidityStatus,DID_REMOVE_ITEM:updateRequiredStatus,DID_SET_ALLOW_BROWSE:toggleAllowBrowse$1,DID_SET_ALLOW_MULTIPLE:toggleAllowMultiple,DID_SET_ACCEPTED_FILE_TYPES:setAcceptedFileTypes,DID_SET_CAPTURE_METHOD:setCaptureMethod,DID_SET_REQUIRED:toggleRequired})}),Key={ENTER:13,SPACE:32},create$13=({root:e,props:t})=>{const r=createElement$1("label");attr(r,"for",`filepond--browser-${t.id}`),attr(r,"id",`filepond--drop-label-${t.id}`),attr(r,"aria-hidden","true"),r.addEventListener("keydown",t=>{t.keyCode!==Key.ENTER&&t.keyCode!==Key.SPACE||(t.preventDefault(),e.ref.label.click())}),updateLabelValue(r,t.caption),e.appendChild(r),e.ref.label=r},updateLabelValue=(e,t)=>{e.innerHTML=t;const r=e.querySelector(".filepond--label-action");return r&&attr(r,"tabindex","0"),t},dropLabel=createView({name:"drop-label",ignoreRect:!0,create:create$13,write:createRoute({DID_SET_LABEL_IDLE:({root:e,action:t})=>{updateLabelValue(e.ref.label,t.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),blob=createView({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),addBlob=({root:e})=>{const t=.5*e.rect.element.width,r=.5*e.rect.element.height;e.ref.blob=e.appendChildView(e.createChildView(blob,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:t,translateY:r}))},moveBlob=({root:e,action:t})=>{e.ref.blob?(e.ref.blob.translateX=t.position.scopeLeft,e.ref.blob.translateY=t.position.scopeTop,e.ref.blob.scaleX=1,e.ref.blob.scaleY=1,e.ref.blob.opacity=1):addBlob({root:e})},hideBlob=({root:e})=>{e.ref.blob&&(e.ref.blob.opacity=0)},explodeBlob=({root:e})=>{e.ref.blob&&(e.ref.blob.scaleX=2.5,e.ref.blob.scaleY=2.5,e.ref.blob.opacity=0)},write$8=({root:e,props:t,actions:r})=>{route$5({root:e,props:t,actions:r});const{blob:o}=e.ref;0===r.length&&o&&0===o.opacity&&(e.removeChildView(o),e.ref.blob=null)},route$5=createRoute({DID_DRAG:moveBlob,DID_DROP:explodeBlob,DID_END_DRAG:hideBlob}),drip=createView({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:write$8}),getRootNode=e=>"getRootNode"in e?e.getRootNode():document,images=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],text$1=["css","csv","html","txt"],map={zip:"zip|compressed",epub:"application/epub+zip"},guesstimateMimeType=(e="")=>(e=e.toLowerCase(),images.includes(e)?"image/"+("jpg"===e?"jpeg":"svg"===e?"svg+xml":e):text$1.includes(e)?"text/"+e:map[e]||null),requestDataTransferItems=e=>new Promise((t,r)=>{const o=getLinks(e);o.length?t(o):getFiles(e).then(t)}),getFiles=e=>new Promise((t,r)=>{const o=(e.items?[...e.items]:[]).filter(e=>isFileSystemItem(e)).map(e=>getFilesFromItem(e));o.length?Promise.all(o).then(e=>{const r=[];e.forEach(e=>{r.push(...e)}),t(r.filter(e=>e))}):t(e.files?[...e.files]:[])}),isFileSystemItem=e=>{if(isEntry(e)){const t=getAsEntry(e);if(t)return t.isFile||t.isDirectory}return"file"===e.kind},getFilesFromItem=e=>new Promise((t,r)=>{isDirectoryEntry(e)?getFilesInDirectory(getAsEntry(e)).then(t):t([e.getAsFile()])}),getFilesInDirectory=e=>new Promise((t,r)=>{const o=[];let i=0;const n=e=>{e.createReader().readEntries(e=>{e.forEach(e=>{e.isDirectory?n(e):(i++,e.file(e=>{o.push(correctMissingFileType(e)),i===o.length&&t(o)}))})})};n(e)}),correctMissingFileType=e=>{if(e.type.length)return e;const t=e.lastModifiedDate,r=e.name;return e=e.slice(0,e.size,guesstimateMimeType(getExtensionFromFilename(e.name))),e.name=r,e.lastModifiedDate=t,e},isDirectoryEntry=e=>isEntry(e)&&(getAsEntry(e)||{}).isDirectory,isEntry=e=>"webkitGetAsEntry"in e,getAsEntry=e=>e.webkitGetAsEntry(),getLinks=e=>{let t=[];try{if((t=getLinksFromTransferMetaData(e)).length)return t;t=getLinksFromTransferURLData(e)}catch(e){}return t},getLinksFromTransferURLData=e=>{let t=e.getData("url");return"string"==typeof t&&t.length?[t]:[]},getLinksFromTransferMetaData=e=>{let t=e.getData("text/html");if("string"==typeof t&&t.length){const e=t.match(/src\s*=\s*"(.+?)"/);if(e)return[e[1]]}return[]},dragNDropObservers=[],eventPosition=e=>({pageLeft:e.pageX,pageTop:e.pageY,scopeLeft:e.offsetX||e.layerX,scopeTop:e.offsetY||e.layerY}),createDragNDropClient=(e,t,r)=>{const o=getDragNDropObserver(t),i={element:e,filterElement:r,state:null,ondrop:()=>{},onenter:()=>{},ondrag:()=>{},onexit:()=>{},onload:()=>{},allowdrop:()=>{}};return i.destroy=o.addListener(i),i},getDragNDropObserver=e=>{const t=dragNDropObservers.find(t=>t.element===e);if(t)return t;const r=createDragNDropObserver(e);return dragNDropObservers.push(r),r},createDragNDropObserver=e=>{const t=[],r={dragenter:dragenter,dragover:dragover,dragleave:dragleave,drop:drop},o={};forin(r,(r,i)=>{o[r]=i(e,t),e.addEventListener(r,o[r],!1)});const i={element:e,addListener:n=>(t.push(n),()=>{t.splice(t.indexOf(n),1),0===t.length&&(dragNDropObservers.splice(dragNDropObservers.indexOf(i),1),forin(r,t=>{e.removeEventListener(t,o[t],!1)}))})};return i},elementFromPoint=(e,t)=>("elementFromPoint"in e||(e=document),e.elementFromPoint(t.x,t.y)),isEventTarget=(e,t)=>{const r=getRootNode(t),o=elementFromPoint(r,{x:e.pageX-window.pageXOffset,y:e.pageY-window.pageYOffset});return o===t||t.contains(o)};let initialTarget=null;const setDropEffect=(e,t)=>{try{e.dropEffect=t}catch(e){}},dragenter=(e,t)=>e=>{e.preventDefault(),initialTarget=e.target,t.forEach(t=>{const{element:r,onenter:o}=t;isEventTarget(e,r)&&(t.state="enter",o(eventPosition(e)))})},dragover=(e,t)=>e=>{e.preventDefault();const r=e.dataTransfer;requestDataTransferItems(r).then(o=>{let i=!1;t.some(t=>{const{filterElement:n,element:a,onenter:s,onexit:l,ondrag:c,allowdrop:p}=t;setDropEffect(r,"copy");const d=p(o);if(d)if(isEventTarget(e,a)){if(i=!0,null===t.state)return t.state="enter",void s(eventPosition(e));if(t.state="over",n&&!d)return void setDropEffect(r,"none");c(eventPosition(e))}else n&&!i&&setDropEffect(r,"none"),t.state&&(t.state=null,l(eventPosition(e)));else setDropEffect(r,"none")})})},drop=(e,t)=>e=>{e.preventDefault();const r=e.dataTransfer;requestDataTransferItems(r).then(r=>{t.forEach(t=>{const{filterElement:o,element:i,ondrop:n,onexit:a,allowdrop:s}=t;t.state=null;s(r)?o&&!isEventTarget(e,i)||n(eventPosition(e),r):a(eventPosition(e))})})},dragleave=(e,t)=>e=>{initialTarget===e.target&&t.forEach(t=>{const{onexit:r}=t;t.state=null,r(eventPosition(e))})},createHopper=(e,t,r)=>{e.classList.add("filepond--hopper");const{catchesDropsOnPage:o,requiresDropOnElement:i}=r,n=createDragNDropClient(e,o?document.documentElement:e,i);let a="",s="";n.allowdrop=(e=>t(e)),n.ondrop=((e,r)=>{t(r)?(s="drag-drop",l.onload(r,e)):l.ondragend(e)}),n.ondrag=(e=>{l.ondrag(e)}),n.onenter=(e=>{s="drag-over",l.ondragstart(e)}),n.onexit=(e=>{s="drag-exit",l.ondragend(e)});const l={updateHopperState:()=>{a!==s&&(e.dataset.hopperState=s,a=s)},onload:()=>{},ondragstart:()=>{},ondrag:()=>{},ondragend:()=>{},destroy:()=>{n.destroy()}};return l};let listening=!1;const listeners$1=[],handlePaste=e=>{requestDataTransferItems(e.clipboardData).then(e=>{e.length&&listeners$1.forEach(t=>t(e))})},listen=e=>{listeners$1.includes(e)||(listeners$1.push(e),listening||(listening=!0,document.addEventListener("paste",handlePaste)))},unlisten=e=>{arrayRemove(listeners$1,listeners$1.indexOf(e)),0===listeners$1.length&&(document.removeEventListener("paste",handlePaste),listening=!1)},createPaster=()=>{const e=e=>{t.onload(e)},t={destroy:()=>{unlisten(e)},onload:()=>{}};return listen(e),t},create$14=({root:e,props:t})=>{e.element.id=`filepond--assistant-${t.id}`,attr(e.element,"role","status"),attr(e.element,"aria-live","polite"),attr(e.element,"aria-relevant","additions")};let addFilesNotificationTimeout=null,notificationClearTimeout=null;const filenames=[],assist=(e,t)=>{e.element.textContent=t},clear$1=e=>{e.element.textContent=""},listModified=(e,t,r)=>{const o=e.query("GET_TOTAL_ITEMS");assist(e,`${r} ${t}, ${o} ${1===o?e.query("GET_LABEL_FILE_COUNT_SINGULAR"):e.query("GET_LABEL_FILE_COUNT_PLURAL")}`),clearTimeout(notificationClearTimeout),notificationClearTimeout=setTimeout(()=>{clear$1(e)},1500)},isUsingFilePond=e=>e.element.parentNode.contains(document.activeElement),itemAdded=({root:e,action:t})=>{if(!isUsingFilePond(e))return;e.element.textContent="";const r=e.query("GET_ITEM",t.id);filenames.push(r.filename),clearTimeout(addFilesNotificationTimeout),addFilesNotificationTimeout=setTimeout(()=>{listModified(e,filenames.join(", "),e.query("GET_LABEL_FILE_ADDED")),filenames.length=0},750)},itemRemoved=({root:e,action:t})=>{if(!isUsingFilePond(e))return;const r=t.item;listModified(e,r.filename,e.query("GET_LABEL_FILE_REMOVED"))},itemProcessed=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename,o=e.query("GET_LABEL_FILE_PROCESSING_COMPLETE");assist(e,`${r} ${o}`)},itemProcessedUndo=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename,o=e.query("GET_LABEL_FILE_PROCESSING_ABORTED");assist(e,`${r} ${o}`)},itemError=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename;assist(e,`${t.status.main} ${r} ${t.status.sub}`)},assistant=createView({create:create$14,ignoreRect:!0,ignoreRectUpdate:!0,write:createRoute({DID_LOAD_ITEM:itemAdded,DID_REMOVE_ITEM:itemRemoved,DID_COMPLETE_ITEM_PROCESSING:itemProcessed,DID_ABORT_ITEM_PROCESSING:itemProcessedUndo,DID_REVERT_ITEM_PROCESSING:itemProcessedUndo,DID_THROW_ITEM_REMOVE_ERROR:itemError,DID_THROW_ITEM_LOAD_ERROR:itemError,DID_THROW_ITEM_INVALID:itemError,DID_THROW_ITEM_PROCESSING_ERROR:itemError}),tag:"span",name:"assistant"}),toCamels=(e,t="-")=>e.replace(new RegExp(`${t}.`,"g"),e=>e.charAt(1).toUpperCase()),debounce=(e,t=16,r=!0)=>{let o=Date.now(),i=null;return(...n)=>{clearTimeout(i);const a=Date.now()-o,s=()=>{o=Date.now(),e(...n)};a<t?r||(i=setTimeout(s,t-a)):s()}},MAX_FILES_LIMIT=1e6,create$1=({root:e,props:t})=>{const r=e.query("GET_ID");r&&(e.element.id=r);const o=e.query("GET_CLASS_NAME");o&&o.split(" ").forEach(t=>{e.element.classList.add(t)}),e.ref.label=e.appendChildView(e.createChildView(dropLabel,Object.assign({},t,{translateY:null,caption:e.query("GET_LABEL_IDLE")}))),e.ref.list=e.appendChildView(e.createChildView(listScroller,{translateY:null})),e.ref.panel=e.appendChildView(e.createChildView(panel,{name:"panel-root"})),e.ref.assistant=e.appendChildView(e.createChildView(assistant,Object.assign({},t))),e.ref.measure=createElement$1("div"),e.ref.measure.style.height="100%",e.element.appendChild(e.ref.measure),e.ref.bounds=null,e.query("GET_STYLES").filter(e=>!isEmpty(e.value)).map(({name:t,value:r})=>{e.element.dataset[t]=r}),e.ref.widthPrevious=null,e.ref.widthUpdated=debounce(()=>{e.dispatch("DID_RESIZE_ROOT")},250),e.ref.updateHistory=[]},write=({root:e,props:t,actions:r})=>{e.rect.element.width!==e.ref.widthPrevious&&(e.ref.widthPrevious=e.rect.element.width,e.ref.widthUpdated());let o=e.ref.bounds;o||(o=e.ref.bounds=calculateRootBoundingBoxHeight(e),e.element.removeChild(e.ref.measure),e.ref.measure=null),route({root:e,props:t,actions:r}),r.filter(e=>/^DID_SET_STYLE_/.test(e.type)).filter(e=>!isEmpty(e.data.value)).map(({type:t,data:r})=>{const o=toCamels(t.substr(8).toLowerCase(),"_");e.element.dataset[o]=r.value,e.invalidateLayout()});const{hopper:i,label:n,list:a,panel:s}=e.ref;i&&i.updateHopperState();const l=e.query("GET_PANEL_ASPECT_RATIO"),c=e.query("GET_ALLOW_MULTIPLE"),p=e.query("GET_TOTAL_ITEMS"),d=p===(c?e.query("GET_MAX_FILES")||1e6:1),u=r.find(e=>"DID_ADD_ITEM"===e.type);if(d&&u){const e=u.data.interactionMethod;n.opacity=0,c?n.translateY=-40:e===InteractionMethod.API?n.translateX=40:n.translateY=e===InteractionMethod.BROWSE?40:30}else d||(n.opacity=1,n.translateX=0,n.translateY=0);const m=calculateListItemMargin(e),E=calculateListHeight(e),I=n.rect.element.height,T=!c||d?0:I,g=d?a.rect.element.marginTop:0,f=0===p?0:a.rect.element.marginBottom,_=T+g+E.visual+f,R=T+g+E.bounds+f;if(a.translateY=Math.max(0,T-a.rect.element.marginTop)-m.top,l){const t=e.rect.element.width,r=t*l,o=e.ref.updateHistory;o.push(t);if(o.length>4){const e=o.length,t=e-10;let r=0;for(let i=e;i>=t;i--)if(o[i]===o[i-2]&&r++,r>=2)return}s.scalable=!1,s.height=r;const i=r-T-(f-m.bottom)-(d?g:0);E.visual>i?a.overflow=i:a.overflow=null,e.height=r}else if(o.fixedHeight){s.scalable=!1;const e=o.fixedHeight-T-(f-m.bottom)-(d?g:0);E.visual>e?a.overflow=e:a.overflow=null}else if(o.cappedHeight){const t=_>=o.cappedHeight,r=Math.min(o.cappedHeight,_);s.scalable=!0,s.height=t?r:r-m.top-m.bottom;const i=r-T-(f-m.bottom)-(d?g:0);_>o.cappedHeight&&E.visual>i?a.overflow=i:a.overflow=null,e.height=Math.min(o.cappedHeight,R-m.top-m.bottom)}else{const t=p>0?m.top+m.bottom:0;s.scalable=!0,s.height=Math.max(I,_-t),e.height=Math.max(I,R-t)}},calculateListItemMargin=e=>{const t=e.ref.list.childViews[0].childViews[0];return t?{top:t.rect.element.marginTop,bottom:t.rect.element.marginBottom}:{top:0,bottom:0}},calculateListHeight=e=>{let t=0,r=0;const o=e.ref.list,i=o.childViews[0],n=i.childViews;if(0===n.length)return{visual:t,bounds:r};const a=i.rect.element.width,s=getItemIndexByPosition(i,o.dragCoordinates),l=n[0].rect.element,c=l.marginTop+l.marginBottom,p=l.marginLeft+l.marginRight,d=l.width+p,u=l.height+c,m=void 0!==s&&s>=0?1:0,E=n.find(e=>e.markedForRemoval&&e.opacity<.45)?-1:0,I=n.length+m+E,T=Math.round(a/d);return 1===T?n.forEach(e=>{const o=e.rect.element.height+c;r+=o,t+=o*e.opacity}):(r=Math.ceil(I/T)*u,t=r),{visual:t,bounds:r}},calculateRootBoundingBoxHeight=e=>{const t=e.ref.measureHeight||null;return{cappedHeight:parseInt(e.style.maxHeight,10)||null,fixedHeight:0===t?null:t}},exceedsMaxFiles=(e,t)=>{const r=e.query("GET_ALLOW_REPLACE"),o=e.query("GET_ALLOW_MULTIPLE"),i=e.query("GET_TOTAL_ITEMS");let n=e.query("GET_MAX_FILES");const a=t.length;if(!o&&a>1)return!0;return!!(isInt(n=o?n:r?n:1)&&i+a>n)&&(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:createResponse("warning",0,"Max files")}),!0)},getDragIndex=(e,t)=>{const r=e.childViews[0];return getItemIndexByPosition(r,{left:t.scopeLeft-r.rect.element.left,top:t.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},toggleAllowDrop=({root:e,props:t,action:r})=>{if(r.value&&!e.ref.hopper){const t=createHopper(e.element,t=>{if(exceedsMaxFiles(e,t))return!1;return!e.query("GET_DROP_VALIDATION")||t.every(t=>applyFilters("ALLOW_HOPPER_ITEM",t,{query:e.query}).every(e=>!0===e))},{catchesDropsOnPage:e.query("GET_DROP_ON_PAGE"),requiresDropOnElement:e.query("GET_DROP_ON_ELEMENT")});t.onload=((t,r)=>{e.dispatch("ADD_ITEMS",{items:t,index:getDragIndex(e.ref.list,r),interactionMethod:InteractionMethod.DROP}),e.dispatch("DID_DROP",{position:r}),e.dispatch("DID_END_DRAG",{position:r})}),t.ondragstart=(t=>{e.dispatch("DID_START_DRAG",{position:t})}),t.ondrag=debounce(t=>{e.dispatch("DID_DRAG",{position:t})}),t.ondragend=(t=>{e.dispatch("DID_END_DRAG",{position:t})}),e.ref.hopper=t,e.ref.drip=e.appendChildView(e.createChildView(drip))}else!r.value&&e.ref.hopper&&(e.ref.hopper.destroy(),e.ref.hopper=null,e.removeChildView(e.ref.drip))},toggleAllowBrowse=({root:e,props:t,action:r})=>{r.value?e.ref.browser=e.appendChildView(e.createChildView(browser,Object.assign({},t,{onload:t=>{if(exceedsMaxFiles(e,t))return!1;e.dispatch("ADD_ITEMS",{items:t,index:-1,interactionMethod:InteractionMethod.BROWSE})}})),0):e.ref.browser&&e.removeChildView(e.ref.browser)},toggleAllowPaste=({root:e,action:t})=>{t.value?(e.ref.paster=createPaster(),e.ref.paster.onload=(t=>{e.dispatch("ADD_ITEMS",{items:t,index:getDragIndex(e.ref.list,position),interactionMethod:InteractionMethod.PASTE})})):e.ref.paster&&(e.ref.paster.destroy(),e.ref.paster=null)},route=createRoute({DID_SET_ALLOW_BROWSE:toggleAllowBrowse,DID_SET_ALLOW_DROP:toggleAllowDrop,DID_SET_ALLOW_PASTE:toggleAllowPaste}),root=createView({name:"root",read:({root:e})=>{e.ref.measure&&(e.ref.measureHeight=e.ref.measure.offsetHeight)},create:create$1,write:write,destroy:({root:e})=>{e.ref.paster&&e.ref.paster.destroy(),e.ref.hopper&&e.ref.hopper.destroy()},mixins:{styles:["height"]}}),createApp$1=(e={})=>{let t=null;const r=getOptions$1(),o=createStore(createInitialState(r),[queries,createOptionQueries(r)],[actions,createOptionActions(r)]);o.dispatch("SET_OPTIONS",{options:e});let i=!1,n=null;const a=()=>{i||(i=!0,o.dispatch("DID_START_RESIZE")),clearTimeout(n),n=setTimeout(()=>{i=!1,o.dispatch("DID_STOP_RESIZE")},500)};window.addEventListener("resize",a);const s=root(o,{id:getUniqueId()});let l=!1,c=!1;const p={_read:()=>{l||(s._read(),c=s.rect.element.hidden)},_write:e=>{if(c)return;const t=o.processActionQueue().filter(e=>!/^SET_/.test(e.type));l&&!t.length||(m(t),l=s._write(e,t,i),removeReleasedItems(o.query("GET_ITEMS")),l&&o.processDispatchQueue())}},d=e=>t=>{const r={type:e};if(!t)return r;if(t.hasOwnProperty("error")&&(r.error=t.error?Object.assign({},t.error):null),t.status&&(r.status=Object.assign({},t.status)),t.file&&(r.output=t.file),t.source)r.file=t.source;else if(t.item||t.id){const e=t.item?t.item:o.query("GET_ITEM",t.id);r.file=e?createItemAPI(e):null}return t.items&&(r.items=t.items.map(createItemAPI)),/progress/.test(e)&&(r.progress=t.progress),r},u={DID_DESTROY:d("destroy"),DID_INIT:d("init"),DID_THROW_MAX_FILES:d("warning"),DID_START_ITEM_LOAD:d("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:d("addfileprogress"),DID_LOAD_ITEM:d("addfile"),DID_THROW_ITEM_INVALID:[d("error"),d("addfile")],DID_THROW_ITEM_LOAD_ERROR:[d("error"),d("addfile")],DID_PREPARE_OUTPUT:d("preparefile"),DID_START_ITEM_PROCESSING:d("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:d("processfileprogress"),DID_ABORT_ITEM_PROCESSING:d("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:d("processfile"),DID_REVERT_ITEM_PROCESSING:d("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[d("error"),d("processfile")],DID_REMOVE_ITEM:d("removefile"),DID_UPDATE_ITEMS:d("updatefiles")},m=e=>{e.length&&e.forEach(e=>{if(!u[e.type])return;const t=u[e.type];(Array.isArray(t)?t:[t]).forEach(t=>{setTimeout(()=>{(e=>{const t=Object.assign({pond:g},e);delete t.type,s.element.dispatchEvent(new CustomEvent(`FilePond:${e.type}`,{detail:t,bubbles:!0,cancelable:!0,composed:!0}));const r=[];e.hasOwnProperty("error")&&r.push(e.error),e.hasOwnProperty("file")&&r.push(e.file);const i=["type","error","file"];Object.keys(e).filter(e=>!i.includes(e)).forEach(t=>r.push(e[t])),g.fire(e.type,...r);const n=o.query(`GET_ON${e.type.toUpperCase()}`);n&&n(...r)})(t(e.data))},0)})})},E=e=>(o.dispatch("REMOVE_ITEM",{query:e}),null===o.query("GET_ACTIVE_ITEM",e)),I=()=>o.query("GET_ACTIVE_ITEMS"),T=e=>new Promise((t,r)=>{o.dispatch("REQUEST_ITEM_PROCESSING",{query:e,success:e=>{t(e)},failure:e=>{r(e)}})}),g=Object.assign({},on(),p,createOptionAPI(o,r),{setOptions:e=>o.dispatch("SET_OPTIONS",{options:e}),addFile:(e,t={})=>new Promise((r,i)=>{o.dispatch("ADD_ITEM",{interactionMethod:InteractionMethod.API,source:e,index:t.index,success:r,failure:i,options:t})}),addFiles:(...e)=>new Promise((t,r)=>{const i=[],n={};if(isArray(e[0]))i.push(...e[0]),Object.assign(n,e[1]||{});else{const t=e[e.length-1];"object"!=typeof t||t instanceof Blob||Object.assign(n,e.pop()),i.push(...e)}o.dispatch("ADD_ITEMS",{items:i,index:n.index,interactionMethod:InteractionMethod.API,success:t,failure:r})}),getFile:e=>o.query("GET_ACTIVE_ITEM",e),processFile:T,removeFile:E,getFiles:I,processFiles:(...e)=>{const t=Array.isArray(e[0])?e[0]:e;if(!t.length){const e=I().filter(e=>e.status!==ItemStatus$1.PROCESSING&&e.status!==ItemStatus$1.PROCESSING_COMPLETE&&e.status!==ItemStatus$1.PROCESSING_REVERT_ERROR);return Promise.all(e.map(T))}return Promise.all(t.map(T))},removeFiles:(...e)=>{const t=Array.isArray(e[0])?e[0]:e,r=I();if(!t.length)return Promise.all(r.map(E));return t.map(e=>isNumber(e)?r[e]?r[e].id:null:e).filter(e=>e).map(E)},sort:e=>o.dispatch("SORT",{compare:e}),browse:()=>{var e=s.element.querySelector("input[type=file]");e&&e.click()},destroy:()=>{g.fire("destroy",s.element),o.dispatch("ABORT_ALL"),s._destroy(),window.removeEventListener("resize",a),o.dispatch("DID_DESTROY")},insertBefore:e=>insertBefore(s.element,e),insertAfter:e=>insertAfter(s.element,e),appendTo:e=>e.appendChild(s.element),replaceElement:e=>{insertBefore(s.element,e),e.parentNode.removeChild(e),t=e},restoreElement:()=>{t&&(insertAfter(t,s.element),s.element.parentNode.removeChild(s.element),t=null)},isAttachedTo:e=>s.element===e||t===e,element:{get:()=>s.element}});return o.dispatch("DID_INIT"),createObject(g)},createAppObject=(e={})=>{const t={};forin(getOptions$1(),(e,r)=>{t[e]=r[0]});return createApp$1(Object.assign({},t,e))},lowerCaseFirstLetter=e=>e.charAt(0).toLowerCase()+e.slice(1),attributeNameToPropertyName=e=>toCamels(e.replace(/^data-/,"")),mapObject=(e,t)=>{forin(t,(t,r)=>{forin(e,(o,i)=>{const n=new RegExp(t);if(!n.test(o))return;if(delete e[o],!1===r)return;if(isString(r))return void(e[r]=i);const a=r.group;isObject(r)&&!e[a]&&(e[a]={}),e[a][lowerCaseFirstLetter(o.replace(n,""))]=i}),r.mapping&&mapObject(e[r.group],r.mapping)})},getAttributesAsObject=(e,t={})=>{const r=[];forin(e.attributes,t=>{r.push(e.attributes[t])});const o=r.filter(e=>e.name).reduce((t,r)=>{const o=attr(e,r.name);return t[attributeNameToPropertyName(r.name)]=o===r.name||o,t},{});return mapObject(o,t),o},createAppAtElement=(e,t={})=>{const r={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};applyFilters("SET_ATTRIBUTE_TO_OPTION_MAP",r);const o=Object.assign({},t),i=getAttributesAsObject("FIELDSET"===e.nodeName?e.querySelector("input[type=file]"):e,r);Object.keys(i).forEach(e=>{isObject(i[e])?(isObject(o[e])||(o[e]={}),Object.assign(o[e],i[e])):o[e]=i[e]}),o.files=(t.files||[]).concat([...e.querySelectorAll("input:not([type=file])")].map(e=>({source:e.value,options:{type:e.dataset.type}})));const n=createAppObject(o);return e.files&&[...e.files].forEach(e=>{n.addFile(e)}),n.replaceElement(e),n},createApp=(...e)=>isNode(e[0])?createAppAtElement(...e):createAppObject(...e),PRIVATE_METHODS=["fire","_read","_write"],createAppAPI=e=>{const t={};return copyObjectPropertiesToObject(e,t,PRIVATE_METHODS),t},replaceInString=(e,t)=>e.replace(/(?:{([a-zA-Z]+)})/g,(e,r)=>t[r]),createWorker=e=>{const t=new Blob(["(",e.toString(),")()"],{type:"application/javascript"}),r=URL.createObjectURL(t),o=new Worker(r);return{transfer:(e,t)=>{},post:(e,t,r)=>{const i=getUniqueId();o.onmessage=(e=>{e.data.id===i&&t(e.data.message)}),o.postMessage({id:i,message:e},r)},terminate:()=>{o.terminate(),URL.revokeObjectURL(r)}}},loadImage=e=>new Promise((t,r)=>{const o=new Image;o.onload=(()=>{t(o)}),o.onerror=(e=>{r(e)}),o.src=e}),renameFile=(e,t)=>{const r=e.slice(0,e.size,e.type);return r.lastModifiedDate=e.lastModifiedDate,r.name=t,r},copyFile=e=>renameFile(e,e.name),registeredPlugins=[],createAppPlugin=e=>{if(registeredPlugins.includes(e))return;registeredPlugins.push(e);const t=e({addFilter:addFilter,utils:{Type:Type,forin:forin,isString:isString,isFile:isFile,toNaturalFileSize:toNaturalFileSize,replaceInString:replaceInString,getExtensionFromFilename:getExtensionFromFilename,getFilenameWithoutExtension:getFilenameWithoutExtension,guesstimateMimeType:guesstimateMimeType,getFileFromBlob:getFileFromBlob,getFilenameFromURL:getFilenameFromURL,createRoute:createRoute,createWorker:createWorker,createView:createView,createItemAPI:createItemAPI,loadImage:loadImage,copyFile:copyFile,renameFile:renameFile,createBlob:createBlob,applyFilterChain:applyFilterChain,text:text,getNumericAspectRatioFromString:getNumericAspectRatioFromString},views:{fileActionButton:fileActionButton}});extendDefaultOptions(t.options)},isOperaMini=()=>"[object OperaMini]"===Object.prototype.toString.call(window.operamini),hasPromises=()=>"Promise"in window,hasBlobSlice=()=>"slice"in Blob.prototype,hasCreateObjectURL=()=>"URL"in window&&"createObjectURL"in window.URL,hasVisibility=()=>"visibilityState"in document,hasTiming=()=>"performance"in window,isBrowser=()=>"undefined"!=typeof window&&void 0!==window.document,supported=(()=>{const e=isBrowser()&&!isOperaMini()&&hasVisibility()&&hasPromises()&&hasBlobSlice()&&hasCreateObjectURL()&&hasTiming();return()=>e})(),state={apps:[]},name="filepond",fn=()=>{};let FileStatus={},OptionTypes={},create=fn,destroy=fn,parse=fn,find=fn,registerPlugin=fn,getOptions=fn,setOptions=fn,FileOrigin={};if(supported()){createPainter(()=>{state.apps.forEach(e=>e._read())},e=>{state.apps.forEach(t=>t._write(e))});const e=()=>{document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:supported,create:create,destroy:destroy,parse:parse,find:find,registerPlugin:registerPlugin,setOptions:setOptions}})),document.removeEventListener("DOMContentLoaded",e)};"loading"!==document.readyState?setTimeout(()=>e(),0):document.addEventListener("DOMContentLoaded",e);const t=()=>forin(getOptions$1(),(e,t)=>{OptionTypes[e]=t[1]});FileOrigin=Object.assign({},FileOrigin$1),FileStatus=Object.assign({},ItemStatus$1),OptionTypes={},t(),create=((...e)=>{const t=createApp(...e);return t.on("destroy",destroy),state.apps.push(t),createAppAPI(t)}),destroy=(e=>{const t=state.apps.findIndex(t=>t.isAttachedTo(e));if(t>=0){return state.apps.splice(t,1)[0].restoreElement(),!0}return!1}),parse=(e=>{return[...e.querySelectorAll(`.${name}`)].filter(e=>!state.apps.find(t=>t.isAttachedTo(e))).map(e=>create(e))}),find=(e=>{const t=state.apps.find(t=>t.isAttachedTo(e));return t?createAppAPI(t):null}),registerPlugin=((...e)=>{e.forEach(createAppPlugin),t()}),getOptions=(()=>{const e={};return forin(getOptions$1(),(t,r)=>{e[t]=r[0]}),e}),setOptions=(e=>(isObject(e)&&(state.apps.forEach(t=>{t.setOptions(e)}),setOptions$1(e)),getOptions()))}export{supported,FileStatus,OptionTypes,create,destroy,parse,find,registerPlugin,getOptions,setOptions,FileOrigin};
